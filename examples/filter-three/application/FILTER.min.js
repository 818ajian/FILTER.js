/** 
*
* FILTER.js Image Processing Filter Library for javascript and HTML5 canvas element
* http://github.com/foo123/FILTER.js
*
* @version 0.2.1 
*
* @author Nikos M. http://nikos-web-development-netai.net
*
**/
document.createElement("canvas").getContext||function(){function c(){return this.context_||(this.context_=new o(this))}function e(a,b){var p=L.call(arguments,2);return function(){return a.apply(b,p.concat(L.call(arguments)))}}function a(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function b(a){a.namespaces.g_vml_||a.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML");a.namespaces.g_o_||a.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");
if(!a.styleSheets.ex_canvas_)a=a.createStyleSheet(),a.owningElement.id="ex_canvas_",a.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}function d(a){var b=a.srcElement;switch(a.propertyName){case "width":b.getContext().clearRect();b.style.width=b.attributes.width.nodeValue+"px";b.firstChild.style.width=b.clientWidth+"px";break;case "height":b.getContext().clearRect(),b.style.height=b.attributes.height.nodeValue+"px",b.firstChild.style.height=b.clientHeight+
"px"}}function f(a){a=a.srcElement;if(a.firstChild)a.firstChild.style.width=a.clientWidth+"px",a.firstChild.style.height=a.clientHeight+"px"}function j(){return[[1,0,0],[0,1,0],[0,0,1]]}function k(a,b){for(var p=j(),e=0;e<3;e++)for(var d=0;d<3;d++){for(var c=0,f=0;f<3;f++)c+=a[e][f]*b[f][d];p[e][d]=c}return p}function w(a,b){b.fillStyle=a.fillStyle;b.lineCap=a.lineCap;b.lineJoin=a.lineJoin;b.lineWidth=a.lineWidth;b.miterLimit=a.miterLimit;b.shadowBlur=a.shadowBlur;b.shadowColor=a.shadowColor;b.shadowOffsetX=
a.shadowOffsetX;b.shadowOffsetY=a.shadowOffsetY;b.strokeStyle=a.strokeStyle;b.globalAlpha=a.globalAlpha;b.font=a.font;b.textAlign=a.textAlign;b.textBaseline=a.textBaseline;b.arcScaleX_=a.arcScaleX_;b.arcScaleY_=a.arcScaleY_;b.lineScale_=a.lineScale_}function q(a){var b=a.indexOf("(",3),p=a.indexOf(")",b+1),b=a.substring(b+1,p).split(",");if(b.length!=4||a.charAt(3)!="a")b[3]=1;return b}function r(a,b,p){return Math.min(p,Math.max(b,a))}function A(a,b,p){p<0&&p++;p>1&&p--;return 6*p<1?a+(b-a)*6*p:
2*p<1?b:3*p<2?a+(b-a)*(2/3-p)*6:a}function x(a){if(a in J)return J[a];var b,p=1,a=String(a);if(a.charAt(0)=="#")b=a;else if(/^rgb/.test(a)){p=q(a);b="#";for(var e,d=0;d<3;d++)e=p[d].indexOf("%")!=-1?Math.floor(parseFloat(p[d])/100*255):+p[d],b+=F[r(e,0,255)];p=+p[3]}else if(/^hsl/.test(a)){d=p=q(a);b=parseFloat(d[0])/360%360;b<0&&b++;e=r(parseFloat(d[1])/100,0,1);d=r(parseFloat(d[2])/100,0,1);if(e==0)e=d=b=d;else{var c=d<0.5?d*(1+e):d+e-d*e,f=2*d-c;e=A(f,c,b+1/3);d=A(f,c,b);b=A(f,c,b-1/3)}b="#"+F[Math.floor(e*
255)]+F[Math.floor(d*255)]+F[Math.floor(b*255)];p=p[3]}else b=N[a]||a;return J[a]={color:b,alpha:p}}function o(a){this.m_=j();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.fillStyle=this.strokeStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=s*1;this.globalAlpha=1;this.font="10px sans-serif";this.textAlign="left";this.textBaseline="alphabetic";this.canvas=a;var b="width:"+a.clientWidth+"px;height:"+a.clientHeight+"px;overflow:hidden;position:absolute",
d=a.ownerDocument.createElement("div");d.style.cssText=b;a.appendChild(d);b=d.cloneNode(!1);b.style.backgroundColor="red";b.style.filter="alpha(opacity=0)";a.appendChild(b);this.element_=d;this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function y(a,b,d,e){a.currentPath_.push({type:"bezierCurveTo",cp1x:b.x,cp1y:b.y,cp2x:d.x,cp2y:d.y,x:e.x,y:e.y});a.currentX_=e.x;a.currentY_=e.y}function z(a,b){var d=x(a.strokeStyle),e=d.color,d=d.alpha*a.globalAlpha,c=a.lineScale_*a.lineWidth;c<1&&(d*=c);b.push("<g_vml_:stroke",
' opacity="',d,'"',' joinstyle="',a.lineJoin,'"',' miterlimit="',a.miterLimit,'"',' endcap="',O[a.lineCap]||"square",'"',' weight="',c,'px"',' color="',e,'" />')}function B(a,b,d,e){var c=a.fillStyle,f=a.arcScaleX_,g=a.arcScaleY_,j=e.x-d.x,m=e.y-d.y;if(c instanceof h){var t=0,e={x:0,y:0},k=0,l=1;if(c.type_=="gradient"){var t=c.x1_/f,d=c.y1_/g,D=n(a,c.x0_/f,c.y0_/g),t=n(a,t,d),t=Math.atan2(t.x-D.x,t.y-D.y)*180/Math.PI;t<0&&(t+=360);t<1.0E-6&&(t=0)}else D=n(a,c.x0_,c.y0_),e={x:(D.x-d.x)/j,y:(D.y-d.y)/
m},j/=f*s,m/=g*s,l=u.max(j,m),k=2*c.r0_/l,l=2*c.r1_/l-k;f=c.colors_;f.sort(function(a,b){return a.offset-b.offset});for(var g=f.length,D=f[0].color,d=f[g-1].color,j=f[0].alpha*a.globalAlpha,a=f[g-1].alpha*a.globalAlpha,m=[],r=0;r<g;r++){var o=f[r];m.push(o.offset*l+k+" "+o.color)}b.push('<g_vml_:fill type="',c.type_,'"',' method="none" focus="100%"',' color="',D,'"',' color2="',d,'"',' colors="',m.join(","),'"',' opacity="',a,'"',' g_o_:opacity2="',j,'"',' angle="',t,'"',' focusposition="',e.x,",",
e.y,'" />')}else c instanceof i?j&&m&&b.push("<g_vml_:fill",' position="',-d.x/j*f*f,",",-d.y/m*g*g,'"',' type="tile"',' src="',c.src_,'" />'):(c=x(a.fillStyle),b.push('<g_vml_:fill color="',c.color,'" opacity="',c.alpha*a.globalAlpha,'" />'))}function n(a,b,d){a=a.m_;return{x:s*(b*a[0][0]+d*a[1][0]+a[2][0])-E,y:s*(b*a[0][1]+d*a[1][1]+a[2][1])-E}}function v(a,b,d){if(isFinite(b[0][0])&&isFinite(b[0][1])&&isFinite(b[1][0])&&isFinite(b[1][1])&&isFinite(b[2][0])&&isFinite(b[2][1])&&(a.m_=b,d))a.lineScale_=
P(Q(b[0][0]*b[1][1]-b[0][1]*b[1][0]))}function h(a){this.type_=a;this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0;this.colors_=[]}function i(a,b){if(!a||a.nodeType!=1||a.tagName!="IMG")throw new l("TYPE_MISMATCH_ERR");if(a.readyState!="complete")throw new l("INVALID_STATE_ERR");switch(b){case "repeat":case null:case "":this.repetition_="repeat";break;case "repeat-x":case "repeat-y":case "no-repeat":this.repetition_=b;break;default:throw new l("SYNTAX_ERR");}this.src_=a.src;this.width_=a.width;
this.height_=a.height}function l(a){this.code=this[a];this.message=a+": DOM Exception "+this.code}var u=Math,m=u.round,C=u.sin,G=u.cos,Q=u.abs,P=u.sqrt,s=10,E=s/2;navigator.userAgent.match(/MSIE ([\d.]+)?/);var L=Array.prototype.slice;b(document);var M={init:function(a){a=a||document;a.createElement("canvas");a.attachEvent("onreadystatechange",e(this.init_,this,a))},init_:function(a){for(var a=a.getElementsByTagName("canvas"),b=0;b<a.length;b++)this.initElement(a[b])},initElement:function(a){if(!a.getContext){a.getContext=
c;b(a.ownerDocument);a.innerHTML="";a.attachEvent("onpropertychange",d);a.attachEvent("onresize",f);var e=a.attributes;e.width&&e.width.specified?a.style.width=e.width.nodeValue+"px":a.width=a.clientWidth;e.height&&e.height.specified?a.style.height=e.height.nodeValue+"px":a.height=a.clientHeight}return a}};M.init();for(var F=[],g=0;g<16;g++)for(var I=0;I<16;I++)F[g*16+I]=g.toString(16)+I.toString(16);var N={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",
bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",
darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",
ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",
mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",
peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},
J={},H={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"},K={},O={butt:"flat",round:"round"},g=o.prototype;g.clearRect=function(){if(this.textMeasureEl_)this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null;this.element_.innerHTML=""};g.beginPath=function(){this.currentPath_=[]};g.moveTo=function(a,b){var d=n(this,a,b);this.currentPath_.push({type:"moveTo",x:d.x,y:d.y});this.currentX_=d.x;this.currentY_=d.y};g.lineTo=function(a,b){var d=n(this,a,b);this.currentPath_.push({type:"lineTo",
x:d.x,y:d.y});this.currentX_=d.x;this.currentY_=d.y};g.bezierCurveTo=function(a,b,d,e,c,f){c=n(this,c,f);a=n(this,a,b);d=n(this,d,e);y(this,a,d,c)};g.quadraticCurveTo=function(a,b,d,e){a=n(this,a,b);d=n(this,d,e);e={x:this.currentX_+2/3*(a.x-this.currentX_),y:this.currentY_+2/3*(a.y-this.currentY_)};y(this,e,{x:e.x+(d.x-this.currentX_)/3,y:e.y+(d.y-this.currentY_)/3},d)};g.arc=function(a,b,d,e,c,f){d*=s;var g=f?"at":"wa",j=a+G(e)*d-E,m=b+C(e)*d-E,e=a+G(c)*d-E,c=b+C(c)*d-E;j==e&&!f&&(j+=0.125);a=n(this,
a,b);j=n(this,j,m);e=n(this,e,c);this.currentPath_.push({type:g,x:a.x,y:a.y,radius:d,xStart:j.x,yStart:j.y,xEnd:e.x,yEnd:e.y})};g.rect=function(a,b,d,e){this.moveTo(a,b);this.lineTo(a+d,b);this.lineTo(a+d,b+e);this.lineTo(a,b+e);this.closePath()};g.strokeRect=function(a,b,d,e){var c=this.currentPath_;this.beginPath();this.moveTo(a,b);this.lineTo(a+d,b);this.lineTo(a+d,b+e);this.lineTo(a,b+e);this.closePath();this.stroke();this.currentPath_=c};g.fillRect=function(a,b,d,e){var c=this.currentPath_;this.beginPath();
this.moveTo(a,b);this.lineTo(a+d,b);this.lineTo(a+d,b+e);this.lineTo(a,b+e);this.closePath();this.fill();this.currentPath_=c};g.createLinearGradient=function(a,b,d,e){var c=new h("gradient");c.x0_=a;c.y0_=b;c.x1_=d;c.y1_=e;return c};g.createRadialGradient=function(a,b,d,e,c,f){var g=new h("gradientradial");g.x0_=a;g.y0_=b;g.r0_=d;g.x1_=e;g.y1_=c;g.r1_=f;return g};g.drawImage=function(a){var b,d,e,c,f,g,j,k;e=a.runtimeStyle.width;c=a.runtimeStyle.height;a.runtimeStyle.width="auto";a.runtimeStyle.height=
"auto";var t=a.width,h=a.height;a.runtimeStyle.width=e;a.runtimeStyle.height=c;if(arguments.length==3)b=arguments[1],d=arguments[2],f=g=0,j=e=t,k=c=h;else if(arguments.length==5)b=arguments[1],d=arguments[2],e=arguments[3],c=arguments[4],f=g=0,j=t,k=h;else if(arguments.length==9)f=arguments[1],g=arguments[2],j=arguments[3],k=arguments[4],b=arguments[5],d=arguments[6],e=arguments[7],c=arguments[8];else throw Error("Invalid number of arguments");var l=n(this,b,d),i=[];i.push(" <g_vml_:group",' coordsize="',
s*10,",",s*10,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]||this.m_[1][1]!=1||this.m_[1][0]){var r=[];r.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",m(l.x/s),",","Dy=",m(l.y/s),"");var o=n(this,b+e,d),q=n(this,b,d+c);b=n(this,b+e,d+c);l.x=u.max(l.x,o.x,q.x,b.x);l.y=u.max(l.y,o.y,q.y,b.y);i.push("padding:0 ",m(l.x/s),"px ",m(l.y/s),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",
r.join(""),", sizingmethod='clip');")}else i.push("top:",m(l.y/s),"px;left:",m(l.x/s),"px;");i.push(' ">','<g_vml_:image src="',a.src,'"',' style="width:',s*e,"px;"," height:",s*c,'px"',' cropleft="',f/t,'"',' croptop="',g/h,'"',' cropright="',(t-f-j)/t,'"',' cropbottom="',(h-g-k)/h,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",i.join(""))};g.stroke=function(a){var b=[];b.push("<g_vml_:shape",' filled="',!!a,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',
' coordorigin="0,0"',' coordsize="',s*10,",",s*10,'"',' stroked="',!a,'"',' path="');for(var d={x:null,y:null},e={x:null,y:null},c=0;c<this.currentPath_.length;c++){var f=this.currentPath_[c];switch(f.type){case "moveTo":b.push(" m ",m(f.x),",",m(f.y));break;case "lineTo":b.push(" l ",m(f.x),",",m(f.y));break;case "close":b.push(" x ");f=null;break;case "bezierCurveTo":b.push(" c ",m(f.cp1x),",",m(f.cp1y),",",m(f.cp2x),",",m(f.cp2y),",",m(f.x),",",m(f.y));break;case "at":case "wa":b.push(" ",f.type,
" ",m(f.x-this.arcScaleX_*f.radius),",",m(f.y-this.arcScaleY_*f.radius)," ",m(f.x+this.arcScaleX_*f.radius),",",m(f.y+this.arcScaleY_*f.radius)," ",m(f.xStart),",",m(f.yStart)," ",m(f.xEnd),",",m(f.yEnd))}if(f){if(d.x==null||f.x<d.x)d.x=f.x;if(e.x==null||f.x>e.x)e.x=f.x;if(d.y==null||f.y<d.y)d.y=f.y;if(e.y==null||f.y>e.y)e.y=f.y}}b.push(' ">');a?B(this,b,d,e):z(this,b);b.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",b.join(""))};g.fill=function(){this.stroke(!0)};g.closePath=
function(){this.currentPath_.push({type:"close"})};g.save=function(){var a={};w(this,a);this.aStack_.push(a);this.mStack_.push(this.m_);this.m_=k(j(),this.m_)};g.restore=function(){if(this.aStack_.length)w(this.aStack_.pop(),this),this.m_=this.mStack_.pop()};g.translate=function(a,b){v(this,k([[1,0,0],[0,1,0],[a,b,1]],this.m_),!1)};g.rotate=function(a){var b=G(a),a=C(a);v(this,k([[b,a,0],[-a,b,0],[0,0,1]],this.m_),!1)};g.scale=function(a,b){this.arcScaleX_*=a;this.arcScaleY_*=b;v(this,k([[a,0,0],
[0,b,0],[0,0,1]],this.m_),!0)};g.transform=function(a,b,d,e,c,f){v(this,k([[a,b,0],[d,e,0],[c,f,1]],this.m_),!0)};g.setTransform=function(a,b,d,e,c,f){v(this,[[a,b,0],[d,e,0],[c,f,1]],!0)};g.drawText_=function(b,d,e,c,f){var g=this.m_,c=0,j=1E3,k={x:0,y:0},l=[],h;h=this.font;if(K[h])h=K[h];else{var i=document.createElement("div").style;try{i.font=h}catch(r){}h=K[h]={style:i.fontStyle||H.style,variant:i.fontVariant||H.variant,weight:i.fontWeight||H.weight,size:i.fontSize||H.size,family:i.fontFamily||
H.family}}var i=h,o=this.element_;h={};for(var q in i)h[q]=i[q];q=parseFloat(o.currentStyle.fontSize);o=parseFloat(i.size);h.size=typeof i.size=="number"?i.size:i.size.indexOf("px")!=-1?o:i.size.indexOf("em")!=-1?q*o:i.size.indexOf("%")!=-1?q/100*o:i.size.indexOf("pt")!=-1?o/0.75:q;h.size*=0.981;q=h.style+" "+h.variant+" "+h.weight+" "+h.size+"px "+h.family;o=this.element_.currentStyle;i=this.textAlign.toLowerCase();switch(i){case "left":case "center":case "right":break;case "end":i=o.direction==
"ltr"?"right":"left";break;case "start":i=o.direction=="rtl"?"right":"left";break;default:i="left"}switch(this.textBaseline){case "hanging":case "top":k.y=h.size/1.75;break;case "middle":break;default:case null:case "alphabetic":case "ideographic":case "bottom":k.y=-h.size/2.25}switch(i){case "right":c=1E3;j=0.05;break;case "center":c=j=500}d=n(this,d+k.x,e+k.y);l.push('<g_vml_:line from="',-c,' 0" to="',j,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!f,'" stroked="',!!f,'" style="position:absolute;width:1px;height:1px;">');
f?z(this,l):B(this,l,{x:-c,y:0},{x:j,y:h.size});f=g[0][0].toFixed(3)+","+g[1][0].toFixed(3)+","+g[0][1].toFixed(3)+","+g[1][1].toFixed(3)+",0,0";d=m(d.x/s)+","+m(d.y/s);l.push('<g_vml_:skew on="t" matrix="',f,'" ',' offset="',d,'" origin="',c,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',a(b),'" style="v-text-align:',i,";font:",a(q),'" /></g_vml_:line>');this.element_.insertAdjacentHTML("beforeEnd",l.join(""))};g.fillText=function(a,b,d,e){this.drawText_(a,b,d,
e,!1)};g.strokeText=function(a,b,d,e){this.drawText_(a,b,d,e,!0)};g.measureText=function(a){if(!this.textMeasureEl_)this.element_.insertAdjacentHTML("beforeEnd",'<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>'),this.textMeasureEl_=this.element_.lastChild;var b=this.element_.ownerDocument;this.textMeasureEl_.innerHTML="";this.textMeasureEl_.style.font=this.font;this.textMeasureEl_.appendChild(b.createTextNode(a));return{width:this.textMeasureEl_.offsetWidth}};
g.clip=function(){};g.arcTo=function(){};g.createPattern=function(a,b){return new i(a,b)};h.prototype.addColorStop=function(a,b){b=x(b);this.colors_.push({offset:a,color:b.color,alpha:b.alpha})};g=l.prototype=Error();g.INDEX_SIZE_ERR=1;g.DOMSTRING_SIZE_ERR=2;g.HIERARCHY_REQUEST_ERR=3;g.WRONG_DOCUMENT_ERR=4;g.INVALID_CHARACTER_ERR=5;g.NO_DATA_ALLOWED_ERR=6;g.NO_MODIFICATION_ALLOWED_ERR=7;g.NOT_FOUND_ERR=8;g.NOT_SUPPORTED_ERR=9;g.INUSE_ATTRIBUTE_ERR=10;g.INVALID_STATE_ERR=11;g.SYNTAX_ERR=12;g.INVALID_MODIFICATION_ERR=
13;g.NAMESPACE_ERR=14;g.INVALID_ACCESS_ERR=15;g.VALIDATION_ERR=16;g.TYPE_MISMATCH_ERR=17;G_vmlCanvasManager=M;CanvasRenderingContext2D=o;CanvasGradient=h;CanvasPattern=i;DOMException=l}();var FILTER=FILTER||{};(function(c){c.Filter=function(e){this.image=e};c.Filter.prototype.apply=function(){}})(FILTER);
(function(c){var e;e={normal:function(a){return a},lighten:function(a,b){return b>a?b:a},darken:function(a,b){return b>a?a:b},multiply:function(a,b){return a*b*0.003921568627451},average:function(a,b){return 0.5*(a+b)},add:function(a,b){return Math.min(255,a+b)},substract:function(a,b){return a+b<255?0:a+b-255},difference:function(a,b){return Math.abs(a-b)},negation:function(a,b){return 255-Math.abs(255-a-b)},screen:function(a,b){return 255-((255-a)*(255-b)>>8)},exclusion:function(a,b){return a+b-
2*a*b*0.003921568627451},overlay:function(a,b){return b<128?2*a*b*0.003921568627451:255-2*(255-a)*(255-b)*0.003921568627451},softLight:function(a,b){return b<128?2*((a>>1)+64)*b*0.003921568627451:255-2*(255-((a>>1)+64))*(255-b)*0.003921568627451},hardLight:function(a,b){return a<128?2*b*a*0.003921568627451:255-2*(255-b)*(255-a)*0.003921568627451},colorDodge:function(a,b){return b==255?b:Math.min(255,(a<<8)/(255-b))},colorBurn:function(a,b){return b==0?b:Math.max(0,255-(255-a<<8)/b)},linearDodge:e.add,
linearBurn:e.substract,linearLight:function(a,b){return b<128?e.linearBurn(a,2*b):e.linearDodge(a,2*(b-128))},vividLight:function(a,b){return b<128?e.colorBurn(a,2*b):e.colorDodge(a,2*(b-128))},pinLight:function(a,b){return b<128?e.darken(a,2*b):e.lighten(a,2*(b-128))},hardMix:function(a,b){return e.vividLight(a,b)<128?0:255},reflect:function(a,b){return b==255?b:Math.min(255,a*a/(255-b))},glow:function(a,b){return a==255?a:Math.min(255,b*b/(255-a))},phoenix:function(a,b){return Math.min(a,b)-Math.max(a,
b)+255}};c.blendModes=e;c.Image=function(a,b){this.height=this.width=0;this.type="undefined";this.context=this.canvasElement=this.image=null;this.canvasElement=document.createElement("canvas");this.canvasElement.width=0;this.canvasElement.height=0;this.context=this.canvasElement.getContext("2d");this.setImage(a,b)};c.Image.prototype={constructor:c.Image,blend:function(a,b,d,c,j){typeof b=="undefined"&&(b="normal");typeof d=="undefined"&&(d=1);d>1&&(d=1);d<0&&(d=0);typeof c=="undefined"&&(c=0);typeof j==
"undefined"&&(j=0);var k=0,w=0;c<0&&(k=-c,c=0);j<0&&(w=-j,j=0);if(!(c>=this.width||j>=this.height)){b=e[b];if(b==void 0||b==null)return this;for(var q=Math.min(this.width,a.width-k),r=Math.min(this.height,a.height-w),A=this.context.getImageData(c,j,q,r),k=a.context.getImageData(k,w,q,r),a=A.data,k=k.data,x,o,y,z=1-d,B=k.length,n=0;n<B;n+=4)x=a[n],o=a[n+1],y=a[n+2],w=b(k[n],x),q=b(k[n+1],o),r=b(k[n+2],y),a[n]=w*d+x*z,a[n+1]=q*d+o*z,a[n+2]=r*d+y*z;this.context.putImageData(A,c,j);return this}},clone:function(a){typeof a==
"undefined"&&(a=!1);return a&&this.image&&this.image.src?new c.Image(this.image.src):new c.Image(this.canvasElement)},createImageData:function(a,b){this.width=a;this.height=b;this.canvasElement.width=this.width;this.canvasElement.height=this.height;this.context=this.canvasElement.getContext("2d");return this.context.createImageData(a,b)},getPixelData:function(){return this.context.getImageData(0,0,this.width,this.height)},setPixelData:function(a){this.context.putImageData(a,0,0);return this},setWidth:function(a){this.width=
a;this.canvasElement.width=this.width;this.context=this.canvasElement.getContext("2d");return this},setHeight:function(a){this.height=a;this.canvasElement.height=this.height;this.context=this.canvasElement.getContext("2d");return this},setImage:function(a,b){if(!(typeof a=="undefined"||a==null)){var d=this;if(a instanceof Image||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement){this.image=a;this.width=a.width;this.height=a.height;this.canvasElement.width=this.width;this.canvasElement.height=
this.height;this.context=this.canvasElement.getContext("2d");this.context.drawImage(this.image,0,0);if(a instanceof Image)this.type="image";if(a instanceof HTMLCanvasElement)this.type="canvas";if(a instanceof HTMLVideoElement)this.type="video"}else this.image=new Image,this.type="image-url",this.image.onload=function(){d.width=d.image.width;d.height=d.image.height;d.canvasElement.width=d.width;d.canvasElement.height=d.height;d.context=d.canvasElement.getContext("2d");d.context.drawImage(d.image,0,
0);typeof b!="undefined"&&b.call(d)},this.image.src=a;this.image.crossOrigin="";return this}}}})(FILTER);
(function(c){c.LUMA={R:0.212671,G:0.71516,B:0.072169};c.ColorMatrixFilter=function(e,a){this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this.image=e;typeof a!="undefined"&&this.concat(a)};c.ColorMatrixFilter.prototype={constructor:c.ColorMatrixFilter,concat:function(e){var a=[],b=0,d,c;for(c=0;c<4;c++){for(d=0;d<5;d++)a[b+d]=e[b]*this.matrix[d]+e[b+1]*this.matrix[d+5]+e[b+2]*this.matrix[d+10]+e[b+3]*this.matrix[d+15]+(d==4?e[b+4]:0);b+=5}this.matrix=a},apply:function(){for(var e=this.image.getPixelData(),
a=e.data,b=this.matrix,d=0;d<a.length;d+=4){var c=[a[d],a[d+1],a[d+2],a[d+3]];a[d]=b[0]*c[0]+b[1]*c[1]+b[2]*c[2]+b[3]*c[3]+b[4];a[d+1]=b[5]*c[0]+b[6]*c[1]+b[7]*c[2]+b[8]*c[3]+b[9];a[d+2]=b[10]*c[0]+b[11]*c[1]+b[12]*c[2]+b[13]*c[3]+b[14];a[d+3]=b[15]*c[0]+b[16]*c[1]+b[17]*c[2]+b[18]*c[3]+b[19]}this.image.setPixelData(e)},grayscale:function(){var e=c.LUMA.R,a=c.LUMA.G,b=c.LUMA.B;this.concat([e,a,b,0,0,e,a,b,0,0,e,a,b,0,0,0,0,0,1,0]);return this},desaturate:function(){this.concat([c.LUMA.R,c.LUMA.G,
c.LUMA.B,0,0,c.LUMA.R,c.LUMA.G,c.LUMA.B,0,0,c.LUMA.R,c.LUMA.G,c.LUMA.B,0,0,0,0,0,1,0]);return this},colorize:function(e,a){var b,d,f,j;typeof a=="undefined"&&(a=1);b=(e>>16&255)/255;d=(e>>8&255)/255;f=(e&255)/255;j=1-a;this.concat([j+a*b*c.LUMA.R,a*b*c.LUMA.G,a*b*c.LUMA.B,0,0,a*d*c.LUMA.R,j+a*d*c.LUMA.G,a*d*c.LUMA.B,0,0,a*f*c.LUMA.R,a*f*c.LUMA.G,j+a*f*c.LUMA.B,0,0,0,0,0,1,0]);return this},invert:function(){this.concat([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]);return this},saturation:function(e){var a,
b,d;a=1-e;b=a*c.LUMA.R;d=a*c.LUMA.G;a*=c.LUMA.B;this.concat([b+e,d,a,0,0,b,d+e,a,0,0,b,d,a+e,0,0,0,0,0,1,0]);return this},contrast:function(c,a,b){typeof a=="undefined"&&(a=c);typeof b=="undefined"&&(b=c);c+=1;a+=1;b+=1;this.concat([c,0,0,0,128*(1-c),0,a,0,0,128*(1-a),0,0,b,0,128*(1-b),0,0,0,1,0]);return this},brightness:function(c,a,b){typeof a=="undefined"&&(a=c);typeof b=="undefined"&&(b=c);this.concat([1,0,0,0,c,0,1,0,0,a,0,0,1,0,b,0,0,0,1,0]);return this},adjustHue:function(e){e*=Math.PI/180;
var a=Math.cos(e),e=Math.sin(e);this.concat([c.LUMA.R+a*(1-c.LUMA.R)+e*-c.LUMA.R,c.LUMA.G+a*-c.LUMA.G+e*-c.LUMA.G,c.LUMA.B+a*-c.LUMA.B+e*(1-c.LUMA.B),0,0,c.LUMA.R+a*-c.LUMA.R+e*0.143,c.LUMA.G+a*(1-c.LUMA.G)+e*0.14,c.LUMA.B+a*-c.LUMA.B+e*-0.283,0,0,c.LUMA.R+a*-c.LUMA.R+e*-(1-c.LUMA.R),c.LUMA.G+a*-c.LUMA.G+e*c.LUMA.G,c.LUMA.B+a*(1-c.LUMA.B)+e*c.LUMA.B,0,0,0,0,0,1,0]);return this},blend:function(c,a){for(var b=1-a,d=0;d<20;)this.matrix[d]=b*this.matrix[d]+a*c.matrix[d],d++},average:function(c,a,b){typeof c==
"undefined"&&(c=1/3);typeof a=="undefined"&&(a=1/3);typeof b=="undefined"&&(b=1/3);this.concat([c,a,b,0,0,c,a,b,0,0,c,a,b,0,0,0,0,0,1,0])},threshold:function(e,a){typeof a=="undefined"&&(a=256);this.concat([c.LUMA.R*a,c.LUMA.G*a,c.LUMA.B*a,0,-(a-1)*e,c.LUMA.R*a,c.LUMA.G*a,c.LUMA.B*a,0,-(a-1)*e,c.LUMA.R*a,c.LUMA.G*a,c.LUMA.B*a,0,-(a-1)*e,0,0,0,1,0])},threshold_rgb:function(c,a){typeof a=="undefined"&&(a=256);this.concat([a,0,0,0,-(a-1)*c,0,a,0,0,-(a-1)*c,0,0,a,0,-(a-1)*c,0,0,0,1,0])},threshold_alpha:function(c,
a){typeof c=="undefined"&&(c=0.5);typeof a=="undefined"&&(a=256);this.concat([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,a,-a*c])}}})(FILTER);
(function(c){var e=typeof Float32Array!=="undefined"?Float32Array:Array;c.ConvolutionMatrixFilter=function(a,b,d){this.image=a;if(typeof b!="undefined")this.weights=b;this.dim=this.weights.length?Math.round(Math.sqrt(this.weights.length)):0;this.opaque=!0;if(typeof d!="undefined")this.opaque=d};c.ConvolutionMatrixFilter.prototype={constructor:c.ConvolutionMatrixFilter,apply:function(){var a=this.dim,b=a>>1,d=this.image.getPixelData(),c=d.data,e=d.width,d=d.height,k=this.image.clone().getPixelData(),
w=this.opaque?1:0,q,r,A,x,o,y=0,z=0,B=0,n=0,v,h,i,l,u,m;for(r=0;r<d;r++){m=r*e;for(q=0;q<e;q++){x=r;A=q;o=m+q<<2;for(h=n=B=z=y=0;h<a;h++){u=h*a;for(v=0;v<a;v++)l=x+h-b,i=A+v-b,l>=0&&l<d&&i>=0&&i<e&&(i=l*e+i<<2,l=this.weights[u+v],y+=c[i]*l,z+=c[i+1]*l,B+=c[i+2]*l,n+=c[i+3]*l)}k.data[o]=y;k.data[o+1]=z;k.data[o+2]=B;k.data[o+3]=n+w*(255-n)}}this.image.setPixelData(k)},eye:function(a){var a=typeof a=="undefined"?3:a%2?a:a+1,b=a*a,c=new e(b),f;for(f=0;f<b;f++)c[f]=0;c[b>>2]=1;this.weights=c;this.dim=
a;return this},lowPass:function(a){var a=typeof a=="undefined"?3:a%2?a:a+1,b=a*a,c=new e(b),f=1/b,j;for(j=0;j<b;j++)c[j]=f;this.weights=c;this.dim=a;return this},highPass:function(a,b){var a=typeof a=="undefined"?3:a%2?a:a+1,b=typeof b=="undefined"?1:b,c=a*a,f=new e(c),j=-b/c,k;for(k=0;k<c;k++)f[k]=j;f[c>>2]=1+j;this.weights=f;this.dim=a;return this},binomialLowPass:function(a){a=3;new e(a*a);this.weights=[0.0625,0.125,0.0625,0.125,0.25,0.125,0.0625,0.125,0.0625];this.dim=a;return this},binomialHighPass:function(a){a=
3;new e(a*a);this.weights=[-0.0625,-0.125,-0.0625,-0.125,0.75,-0.125,-0.0625,-0.125,-0.0625];this.dim=a;return this},gradX:function(){var a=Math.sqrt(2);this.weights=[-1,0,1,-a,0,a,-1,0,1];this.dim=3;return this},gradY:function(){var a=Math.sqrt(2);this.weights=[1,a,1,0,0,0,-1,-a,-1];this.dim=3;return this},gradTheta:function(a){var b=Math.cos(a),a=Math.sin(a);this.weights=[-b+a,a,b+a,-b,0,a,-b-a,-a,b-a];this.dim=3;return this},sobelGradX:function(){this.weights=[-1,0,1,-2,0,2,-1,0,1];this.dim=3;
return this},sobelGradY:function(){this.weights=[1,2,1,0,0,0,-1,-2,-1];this.dim=3;return this},laplacian:function(){this.weights=[0,-1,0,-1,4,-1,0,-1,0];this.dim=3;return this},emboss:function(){this.weights=[-2,-1,0,-1,1,1,0,1,2];this.dim=3;return this},motionblur:function(a){var b=1/9;this.weights=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];if(a==0)for(a=0;a<9;a++)this.weights[36+
a]=b;else if(a==2)for(a=0;a<9;a++)this.weights[9*a+5]=b;else if(a==1)for(a=0;a<9;a++)this.weights[9*Math.round(a)+Math.round(a)]=b;return this},blur:function(a){return this.lowPass(a)},sharpen:function(a,b){return this.highPass(a,typeof b=="undefined"?0.5:b)},gauss:function(a){return this.binomialLowPass(a)}}})(FILTER);
(function(c){c.CHANNEL={RED:0,GREEN:1,BLUE:2,ALPHA:3};c.MODE={IGNORE:0,WRAP:1,CLAMP:2,COLOR:4};c.DisplacementMapFilter=function(e,a){this.scaleY=this.scaleX=1;this.color=this.componentY=this.componentX=this.startY=this.startX=0;this.mode=c.MODE.CLAMP;this.image=e;this.map=a};c.DisplacementMapFilter.prototype={constructor:c.DisplacementMapFilter,apply:function(){var e=this.image.getPixelData(),a=e.width,b=e.height,d=this.map.clone().getPixelData(),f=d.data,j=d.width,k=d.height,d=this.image.clone().getPixelData(),
w=this.scaleX/256,q=this.scaleY/256,r=this.color>>24&255,A=this.color>>16&255,x=this.color>>8&255,o=this.color&255,y=Math.min(j,a),k=Math.min(k,b),z=Math.floor(this.startY),B=Math.floor(this.startX),n=this.componentX,v=this.componentY,h,i,l,u,m,C,G=this.mode;for(C=0;C<k;C++)for(m=0;m<y;m++)if(i=C+z,h=m+B,!(i<0||i>=b||h<0||h>=a)){l=(i*a+h)*4;u=(C*j+m)*4;i+=Math.floor((f[u+v]-128)*q);h+=Math.floor((f[u+n]-128)*w);if(i>=b||i<0||h>=a||h<0)switch(G){case c.MODE.IGNORE:continue;case c.MODE.COLOR:d.data[l]=
A;d.data[l+1]=x;d.data[l+2]=o;d.data[l+3]=r;continue;case c.MODE.WRAP:i>=b&&(i-=b);i<0&&(i+=b);h>=a&&(h-=a);h<0&&(h+=a);break;default:i>=b&&(i=b-1),i<0&&(i=0),h>=a&&(h=a-1),h<0&&(h=0)}h=(i*a+h)*4;d.data[l]=e.data[h];d.data[l+1]=e.data[h+1];d.data[l+2]=e.data[h+2];d.data[l+3]=e.data[h+3]}this.image.setPixelData(d)}}})(FILTER);
(function(c){c.SobelFilter=function(c){this.image=c};c.SobelFilter.prototype=new c.Filter;c.SobelFilter.prototype.constructor=c.SobelFilter;c.SobelFilter.prototype.apply=function(){(new c.ColorMatrixFilter(this.image)).grayscale().apply();var e=this.image.getPixelData();(new c.ConvolutionMatrixFilter(this.image)).sobelGradX().apply();var a=this.image.getPixelData();this.image.setPixelData(e);(new c.ConvolutionMatrixFilter(this.image)).sobelGradY().apply();for(var b=this.image.getPixelData(),d=[],
f=0;f<e.data.length;f+=4){var j=Math.abs(a.data[f]);d[f]=j;var k=Math.abs(b.data[f]);d[f+1]=k;d[f+2]=(j+k)/4;d[f+3]=255}e=this.image.getPixelData();for(f=0;f<e.data.length;f++)e.data[f]=d[f];this.image.setPixelData(e,0,0)}})(FILTER);
