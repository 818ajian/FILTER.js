/** 
*
* http://github.com/foo123/FILTER.js
*
* FILTER.js
* Image Processing Filter Library for javascript and HTML5 canvas element
* @version 0.2 
* @author Nikos M.
* @url http://nikos-web-development-netai.net
*
**/
document.createElement("canvas").getContext||function(){function c(){return this.context_||(this.context_=new x(this))}function a(q,a){var b=O.call(arguments,2);return function(){return q.apply(a,b.concat(O.call(arguments)))}}function b(q){return String(q).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function f(q){q.namespaces.g_vml_||q.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML");q.namespaces.g_o_||q.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");
if(!q.styleSheets.ex_canvas_)q=q.createStyleSheet(),q.owningElement.id="ex_canvas_",q.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}function d(q){var a=q.srcElement;switch(q.propertyName){case "width":a.getContext().clearRect();a.style.width=a.attributes.width.nodeValue+"px";a.firstChild.style.width=a.clientWidth+"px";break;case "height":a.getContext().clearRect(),a.style.height=a.attributes.height.nodeValue+"px",a.firstChild.style.height=a.clientHeight+
"px"}}function e(q){q=q.srcElement;if(q.firstChild)q.firstChild.style.width=q.clientWidth+"px",q.firstChild.style.height=q.clientHeight+"px"}function h(){return[[1,0,0],[0,1,0],[0,0,1]]}function o(q,a){for(var b=h(),c=0;c<3;c++)for(var f=0;f<3;f++){for(var F=0,d=0;d<3;d++)F+=q[c][d]*a[d][f];b[c][f]=F}return b}function r(a,b){b.fillStyle=a.fillStyle;b.lineCap=a.lineCap;b.lineJoin=a.lineJoin;b.lineWidth=a.lineWidth;b.miterLimit=a.miterLimit;b.shadowBlur=a.shadowBlur;b.shadowColor=a.shadowColor;b.shadowOffsetX=
a.shadowOffsetX;b.shadowOffsetY=a.shadowOffsetY;b.strokeStyle=a.strokeStyle;b.globalAlpha=a.globalAlpha;b.font=a.font;b.textAlign=a.textAlign;b.textBaseline=a.textBaseline;b.arcScaleX_=a.arcScaleX_;b.arcScaleY_=a.arcScaleY_;b.lineScale_=a.lineScale_}function v(a){var b=a.indexOf("(",3),c=a.indexOf(")",b+1),b=a.substring(b+1,c).split(",");if(b.length!=4||a.charAt(3)!="a")b[3]=1;return b}function C(a,b,c){return Math.min(c,Math.max(b,a))}function A(a,b,c){c<0&&c++;c>1&&c--;return 6*c<1?a+(b-a)*6*c:
2*c<1?b:3*c<2?a+(b-a)*(2/3-c)*6:a}function w(a){if(a in M)return M[a];var b,c=1,a=String(a);if(a.charAt(0)=="#")b=a;else if(/^rgb/.test(a)){c=v(a);b="#";for(var f,l=0;l<3;l++)f=c[l].indexOf("%")!=-1?Math.floor(parseFloat(c[l])/100*255):+c[l],b+=I[C(f,0,255)];c=+c[3]}else if(/^hsl/.test(a)){l=c=v(a);b=parseFloat(l[0])/360%360;b<0&&b++;f=C(parseFloat(l[1])/100,0,1);l=C(parseFloat(l[2])/100,0,1);if(f==0)f=l=b=l;else{var F=l<0.5?l*(1+f):l+f-l*f,d=2*l-F;f=A(d,F,b+1/3);l=A(d,F,b);b=A(d,F,b-1/3)}b="#"+I[Math.floor(f*
255)]+I[Math.floor(l*255)]+I[Math.floor(b*255)];c=c[3]}else b=Q[a]||a;return M[a]={color:b,alpha:c}}function x(a){this.m_=h();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.fillStyle=this.strokeStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=u*1;this.globalAlpha=1;this.font="10px sans-serif";this.textAlign="left";this.textBaseline="alphabetic";this.canvas=a;var b="width:"+a.clientWidth+"px;height:"+a.clientHeight+"px;overflow:hidden;position:absolute",
c=a.ownerDocument.createElement("div");c.style.cssText=b;a.appendChild(c);b=c.cloneNode(!1);b.style.backgroundColor="red";b.style.filter="alpha(opacity=0)";a.appendChild(b);this.element_=c;this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function B(a,b,c,f){a.currentPath_.push({type:"bezierCurveTo",cp1x:b.x,cp1y:b.y,cp2x:c.x,cp2y:c.y,x:f.x,y:f.y});a.currentX_=f.x;a.currentY_=f.y}function D(a,b){var c=w(a.strokeStyle),f=c.color,c=c.alpha*a.globalAlpha,l=a.lineScale_*a.lineWidth;l<1&&(c*=l);b.push("<g_vml_:stroke",
' opacity="',c,'"',' joinstyle="',a.lineJoin,'"',' miterlimit="',a.miterLimit,'"',' endcap="',R[a.lineCap]||"square",'"',' weight="',l,'px"',' color="',f,'" />')}function s(a,b,c,f){var l=a.fillStyle,d=a.arcScaleX_,e=a.arcScaleY_,g=f.x-c.x,i=f.y-c.y;if(l instanceof j){var m=0,f={x:0,y:0},n=0,h=1;if(l.type_=="gradient"){var m=l.x1_/d,c=l.y1_/e,G=t(a,l.x0_/d,l.y0_/e),m=t(a,m,c),m=Math.atan2(m.x-G.x,m.y-G.y)*180/Math.PI;m<0&&(m+=360);m<1.0E-6&&(m=0)}else G=t(a,l.x0_,l.y0_),f={x:(G.x-c.x)/g,y:(G.y-c.y)/
i},g/=d*u,i/=e*u,h=y.max(g,i),n=2*l.r0_/h,h=2*l.r1_/h-n;d=l.colors_;d.sort(function(a,b){return a.offset-b.offset});for(var e=d.length,G=d[0].color,c=d[e-1].color,g=d[0].alpha*a.globalAlpha,a=d[e-1].alpha*a.globalAlpha,i=[],o=0;o<e;o++){var s=d[o];i.push(s.offset*h+n+" "+s.color)}b.push('<g_vml_:fill type="',l.type_,'"',' method="none" focus="100%"',' color="',G,'"',' color2="',c,'"',' colors="',i.join(","),'"',' opacity="',a,'"',' g_o_:opacity2="',g,'"',' angle="',m,'"',' focusposition="',f.x,",",
f.y,'" />')}else l instanceof k?g&&i&&b.push("<g_vml_:fill",' position="',-c.x/g*d*d,",",-c.y/i*e*e,'"',' type="tile"',' src="',l.src_,'" />'):(l=w(a.fillStyle),b.push('<g_vml_:fill color="',l.color,'" opacity="',l.alpha*a.globalAlpha,'" />'))}function t(a,b,c){a=a.m_;return{x:u*(b*a[0][0]+c*a[1][0]+a[2][0])-H,y:u*(b*a[0][1]+c*a[1][1]+a[2][1])-H}}function z(a,b,c){if(isFinite(b[0][0])&&isFinite(b[0][1])&&isFinite(b[1][0])&&isFinite(b[1][1])&&isFinite(b[2][0])&&isFinite(b[2][1])&&(a.m_=b,c))a.lineScale_=
S(T(b[0][0]*b[1][1]-b[0][1]*b[1][0]))}function j(a){this.type_=a;this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0;this.colors_=[]}function k(a,b){if(!a||a.nodeType!=1||a.tagName!="IMG")throw new p("TYPE_MISMATCH_ERR");if(a.readyState!="complete")throw new p("INVALID_STATE_ERR");switch(b){case "repeat":case null:case "":this.repetition_="repeat";break;case "repeat-x":case "repeat-y":case "no-repeat":this.repetition_=b;break;default:throw new p("SYNTAX_ERR");}this.src_=a.src;this.width_=a.width;
this.height_=a.height}function p(a){this.code=this[a];this.message=a+": DOM Exception "+this.code}var y=Math,i=y.round,E=y.sin,J=y.cos,T=y.abs,S=y.sqrt,u=10,H=u/2;navigator.userAgent.match(/MSIE ([\d.]+)?/);var O=Array.prototype.slice;f(document);var P={init:function(b){b=b||document;b.createElement("canvas");b.attachEvent("onreadystatechange",a(this.init_,this,b))},init_:function(a){for(var a=a.getElementsByTagName("canvas"),b=0;b<a.length;b++)this.initElement(a[b])},initElement:function(a){if(!a.getContext){a.getContext=
c;f(a.ownerDocument);a.innerHTML="";a.attachEvent("onpropertychange",d);a.attachEvent("onresize",e);var b=a.attributes;b.width&&b.width.specified?a.style.width=b.width.nodeValue+"px":a.width=a.clientWidth;b.height&&b.height.specified?a.style.height=b.height.nodeValue+"px":a.height=a.clientHeight}return a}};P.init();for(var I=[],g=0;g<16;g++)for(var L=0;L<16;L++)I[g*16+L]=g.toString(16)+L.toString(16);var Q={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",
bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",
darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",
ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",
mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",
peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},
M={},K={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"},N={},R={butt:"flat",round:"round"},g=x.prototype;g.clearRect=function(){if(this.textMeasureEl_)this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null;this.element_.innerHTML=""};g.beginPath=function(){this.currentPath_=[]};g.moveTo=function(a,b){var c=t(this,a,b);this.currentPath_.push({type:"moveTo",x:c.x,y:c.y});this.currentX_=c.x;this.currentY_=c.y};g.lineTo=function(a,b){var c=t(this,a,b);this.currentPath_.push({type:"lineTo",
x:c.x,y:c.y});this.currentX_=c.x;this.currentY_=c.y};g.bezierCurveTo=function(a,b,c,f,d,e){d=t(this,d,e);a=t(this,a,b);c=t(this,c,f);B(this,a,c,d)};g.quadraticCurveTo=function(a,b,c,f){a=t(this,a,b);c=t(this,c,f);f={x:this.currentX_+2/3*(a.x-this.currentX_),y:this.currentY_+2/3*(a.y-this.currentY_)};B(this,f,{x:f.x+(c.x-this.currentX_)/3,y:f.y+(c.y-this.currentY_)/3},c)};g.arc=function(a,b,c,f,d,e){c*=u;var g=e?"at":"wa",i=a+J(f)*c-H,h=b+E(f)*c-H,f=a+J(d)*c-H,d=b+E(d)*c-H;i==f&&!e&&(i+=0.125);a=t(this,
a,b);i=t(this,i,h);f=t(this,f,d);this.currentPath_.push({type:g,x:a.x,y:a.y,radius:c,xStart:i.x,yStart:i.y,xEnd:f.x,yEnd:f.y})};g.rect=function(a,b,c,f){this.moveTo(a,b);this.lineTo(a+c,b);this.lineTo(a+c,b+f);this.lineTo(a,b+f);this.closePath()};g.strokeRect=function(a,b,c,f){var d=this.currentPath_;this.beginPath();this.moveTo(a,b);this.lineTo(a+c,b);this.lineTo(a+c,b+f);this.lineTo(a,b+f);this.closePath();this.stroke();this.currentPath_=d};g.fillRect=function(a,b,c,f){var d=this.currentPath_;this.beginPath();
this.moveTo(a,b);this.lineTo(a+c,b);this.lineTo(a+c,b+f);this.lineTo(a,b+f);this.closePath();this.fill();this.currentPath_=d};g.createLinearGradient=function(a,b,c,f){var d=new j("gradient");d.x0_=a;d.y0_=b;d.x1_=c;d.y1_=f;return d};g.createRadialGradient=function(a,b,c,f,d,e){var g=new j("gradientradial");g.x0_=a;g.y0_=b;g.r0_=c;g.x1_=f;g.y1_=d;g.r1_=e;return g};g.drawImage=function(a){var b,c,f,d,e,g,h,j;f=a.runtimeStyle.width;d=a.runtimeStyle.height;a.runtimeStyle.width="auto";a.runtimeStyle.height=
"auto";var m=a.width,n=a.height;a.runtimeStyle.width=f;a.runtimeStyle.height=d;if(arguments.length==3)b=arguments[1],c=arguments[2],e=g=0,h=f=m,j=d=n;else if(arguments.length==5)b=arguments[1],c=arguments[2],f=arguments[3],d=arguments[4],e=g=0,h=m,j=n;else if(arguments.length==9)e=arguments[1],g=arguments[2],h=arguments[3],j=arguments[4],b=arguments[5],c=arguments[6],f=arguments[7],d=arguments[8];else throw Error("Invalid number of arguments");var k=t(this,b,c),o=[];o.push(" <g_vml_:group",' coordsize="',
u*10,",",u*10,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]||this.m_[1][1]!=1||this.m_[1][0]){var s=[];s.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",i(k.x/u),",","Dy=",i(k.y/u),"");var p=t(this,b+f,c),r=t(this,b,c+d);b=t(this,b+f,c+d);k.x=y.max(k.x,p.x,r.x,b.x);k.y=y.max(k.y,p.y,r.y,b.y);o.push("padding:0 ",i(k.x/u),"px ",i(k.y/u),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",
s.join(""),", sizingmethod='clip');")}else o.push("top:",i(k.y/u),"px;left:",i(k.x/u),"px;");o.push(' ">','<g_vml_:image src="',a.src,'"',' style="width:',u*f,"px;"," height:",u*d,'px"',' cropleft="',e/m,'"',' croptop="',g/n,'"',' cropright="',(m-e-h)/m,'"',' cropbottom="',(n-g-j)/n,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",o.join(""))};g.stroke=function(a){var b=[];b.push("<g_vml_:shape",' filled="',!!a,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',
' coordorigin="0,0"',' coordsize="',u*10,",",u*10,'"',' stroked="',!a,'"',' path="');for(var c={x:null,y:null},f={x:null,y:null},d=0;d<this.currentPath_.length;d++){var e=this.currentPath_[d];switch(e.type){case "moveTo":b.push(" m ",i(e.x),",",i(e.y));break;case "lineTo":b.push(" l ",i(e.x),",",i(e.y));break;case "close":b.push(" x ");e=null;break;case "bezierCurveTo":b.push(" c ",i(e.cp1x),",",i(e.cp1y),",",i(e.cp2x),",",i(e.cp2y),",",i(e.x),",",i(e.y));break;case "at":case "wa":b.push(" ",e.type,
" ",i(e.x-this.arcScaleX_*e.radius),",",i(e.y-this.arcScaleY_*e.radius)," ",i(e.x+this.arcScaleX_*e.radius),",",i(e.y+this.arcScaleY_*e.radius)," ",i(e.xStart),",",i(e.yStart)," ",i(e.xEnd),",",i(e.yEnd))}if(e){if(c.x==null||e.x<c.x)c.x=e.x;if(f.x==null||e.x>f.x)f.x=e.x;if(c.y==null||e.y<c.y)c.y=e.y;if(f.y==null||e.y>f.y)f.y=e.y}}b.push(' ">');a?s(this,b,c,f):D(this,b);b.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",b.join(""))};g.fill=function(){this.stroke(!0)};g.closePath=
function(){this.currentPath_.push({type:"close"})};g.save=function(){var a={};r(this,a);this.aStack_.push(a);this.mStack_.push(this.m_);this.m_=o(h(),this.m_)};g.restore=function(){if(this.aStack_.length)r(this.aStack_.pop(),this),this.m_=this.mStack_.pop()};g.translate=function(a,b){z(this,o([[1,0,0],[0,1,0],[a,b,1]],this.m_),!1)};g.rotate=function(a){var b=J(a),a=E(a);z(this,o([[b,a,0],[-a,b,0],[0,0,1]],this.m_),!1)};g.scale=function(a,b){this.arcScaleX_*=a;this.arcScaleY_*=b;z(this,o([[a,0,0],
[0,b,0],[0,0,1]],this.m_),!0)};g.transform=function(a,b,c,f,d,e){z(this,o([[a,b,0],[c,f,0],[d,e,1]],this.m_),!0)};g.setTransform=function(a,b,c,f,d,e){z(this,[[a,b,0],[c,f,0],[d,e,1]],!0)};g.drawText_=function(a,c,f,d,e){var g=this.m_,d=0,h=1E3,j={x:0,y:0},k=[],m;m=this.font;if(N[m])m=N[m];else{var n=document.createElement("div").style;try{n.font=m}catch(o){}m=N[m]={style:n.fontStyle||K.style,variant:n.fontVariant||K.variant,weight:n.fontWeight||K.weight,size:n.fontSize||K.size,family:n.fontFamily||
K.family}}var n=m,p=this.element_;m={};for(var r in n)m[r]=n[r];r=parseFloat(p.currentStyle.fontSize);p=parseFloat(n.size);m.size=typeof n.size=="number"?n.size:n.size.indexOf("px")!=-1?p:n.size.indexOf("em")!=-1?r*p:n.size.indexOf("%")!=-1?r/100*p:n.size.indexOf("pt")!=-1?p/0.75:r;m.size*=0.981;r=m.style+" "+m.variant+" "+m.weight+" "+m.size+"px "+m.family;p=this.element_.currentStyle;n=this.textAlign.toLowerCase();switch(n){case "left":case "center":case "right":break;case "end":n=p.direction==
"ltr"?"right":"left";break;case "start":n=p.direction=="rtl"?"right":"left";break;default:n="left"}switch(this.textBaseline){case "hanging":case "top":j.y=m.size/1.75;break;case "middle":break;default:case null:case "alphabetic":case "ideographic":case "bottom":j.y=-m.size/2.25}switch(n){case "right":d=1E3;h=0.05;break;case "center":d=h=500}c=t(this,c+j.x,f+j.y);k.push('<g_vml_:line from="',-d,' 0" to="',h,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!e,'" stroked="',!!e,'" style="position:absolute;width:1px;height:1px;">');
e?D(this,k):s(this,k,{x:-d,y:0},{x:h,y:m.size});e=g[0][0].toFixed(3)+","+g[1][0].toFixed(3)+","+g[0][1].toFixed(3)+","+g[1][1].toFixed(3)+",0,0";c=i(c.x/u)+","+i(c.y/u);k.push('<g_vml_:skew on="t" matrix="',e,'" ',' offset="',c,'" origin="',d,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',b(a),'" style="v-text-align:',n,";font:",b(r),'" /></g_vml_:line>');this.element_.insertAdjacentHTML("beforeEnd",k.join(""))};g.fillText=function(a,b,c,f){this.drawText_(a,b,c,
f,!1)};g.strokeText=function(a,b,c,f){this.drawText_(a,b,c,f,!0)};g.measureText=function(a){if(!this.textMeasureEl_)this.element_.insertAdjacentHTML("beforeEnd",'<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>'),this.textMeasureEl_=this.element_.lastChild;var b=this.element_.ownerDocument;this.textMeasureEl_.innerHTML="";this.textMeasureEl_.style.font=this.font;this.textMeasureEl_.appendChild(b.createTextNode(a));return{width:this.textMeasureEl_.offsetWidth}};
g.clip=function(){};g.arcTo=function(){};g.createPattern=function(a,b){return new k(a,b)};j.prototype.addColorStop=function(a,b){b=w(b);this.colors_.push({offset:a,color:b.color,alpha:b.alpha})};g=p.prototype=Error();g.INDEX_SIZE_ERR=1;g.DOMSTRING_SIZE_ERR=2;g.HIERARCHY_REQUEST_ERR=3;g.WRONG_DOCUMENT_ERR=4;g.INVALID_CHARACTER_ERR=5;g.NO_DATA_ALLOWED_ERR=6;g.NO_MODIFICATION_ALLOWED_ERR=7;g.NOT_FOUND_ERR=8;g.NOT_SUPPORTED_ERR=9;g.INUSE_ATTRIBUTE_ERR=10;g.INVALID_STATE_ERR=11;g.SYNTAX_ERR=12;g.INVALID_MODIFICATION_ERR=
13;g.NAMESPACE_ERR=14;g.INVALID_ACCESS_ERR=15;g.VALIDATION_ERR=16;g.TYPE_MISMATCH_ERR=17;G_vmlCanvasManager=P;CanvasRenderingContext2D=x;CanvasGradient=j;CanvasPattern=k;DOMException=p}();var FILTER=FILTER||{};(function(c){c.Filter=function(a){this.image=a};c.Filter.prototype.apply=function(){}})(FILTER);
(function(c){c.Image=function(a,b){this.height=this.width=0;this.type="undefined";this.context=this.canvasElement=this.image=null;this.canvasElement=document.createElement("canvas");this.canvasElement.width=0;this.canvasElement.height=0;this.context=this.canvasElement.getContext("2d");this.setImage(a,b)};c.blendModes={normal:function(a){return a},lighten:function(a,b){return b>a?b:a},darken:function(a,b){return b>a?a:b},multiply:function(a,b){return a*b/255},average:function(a,b){return(a+b)/2},add:function(a,
b){return Math.min(255,a+b)},substract:function(a,b){return a+b<255?0:a+b-255},difference:function(a,b){return Math.abs(a-b)},negation:function(a,b){return 255-Math.abs(255-a-b)},screen:function(a,b){return 255-((255-a)*(255-b)>>8)},exclusion:function(a,b){return a+b-2*a*b/255},overlay:function(a,b){return b<128?2*a*b/255:255-2*(255-a)*(255-b)/255},softLight:function(a,b){return b<128?2*((a>>1)+64)*(b/255):255-2*(255-((a>>1)+64))*(255-b)/255},hardLight:function(a,b){return c.blendModes.overlay(b,
a)},colorDodge:function(a,b){return b==255?b:Math.min(255,(a<<8)/(255-b))},colorBurn:function(a,b){return b==0?b:Math.max(0,255-(255-a<<8)/b)},linearDodge:function(a,b){return c.blendModes.add(a,b)},linearBurn:function(a,b){return c.blendModes.substract(a,b)},linearLight:function(a,b){return b<128?c.blendModes.linearBurn(a,2*b):c.blendModes.linearDodge(a,2*(b-128))},vividLight:function(a,b){return b<128?c.blendModes.colorBurn(a,2*b):c.blendModes.colorDodge(a,2*(b-128))},pinLight:function(a,b){return b<
128?c.blendModes.darken(a,2*b):c.blendModes.lighten(a,2*(b-128))},hardMix:function(a,b){return c.blendModes.vividLight(a,b)<128?0:255},reflect:function(a,b){return b==255?b:Math.min(255,a*a/(255-b))},glow:function(a,b){return c.blendModes.reflect(b,a)},phoenix:function(a,b){return Math.min(a,b)-Math.max(a,b)+255}};c.Image.prototype.blend=function(a,b,f,d,e){typeof b=="undefined"&&(b="normal");typeof f=="undefined"&&(f=1);f>1&&(f=1);f<0&&(f=0);typeof d=="undefined"&&(d=0);typeof e=="undefined"&&(e=
0);var h=0,o=0;d<0&&(h=-d,d=0);e<0&&(o=-e,e=0);if(!(d>=this.width||e>=this.height)){b=c.blendModes[b];if(b==void 0||b==null)return this;for(var r=Math.min(this.width,a.width-h),v=Math.min(this.height,a.height-o),C=this.context.getImageData(d,e,r,v),h=a.context.getImageData(h,o,r,v),a=C.data,h=h.data,A,w,x,B=1-f,D=h.length,s=0;s<D;s+=4)A=a[s],w=a[s+1],x=a[s+2],o=b(h[s],A),r=b(h[s+1],w),v=b(h[s+2],x),a[s]=o*f+A*B,a[s+1]=r*f+w*B,a[s+2]=v*f+x*B;this.context.putImageData(C,d,e);return this}};c.Image.prototype.clone=
function(a){typeof a=="undefined"&&(a=!1);return a&&this.image&&this.image.src?new c.Image(this.image.src):new c.Image(this.canvasElement)};c.Image.prototype.createImageData=function(a,b){this.width=a;this.height=b;this.canvasElement.width=this.width;this.canvasElement.height=this.height;this.context=this.canvasElement.getContext("2d");return this.context.createImageData(a,b)};c.Image.prototype.getPixelData=function(){return this.context.getImageData(0,0,this.width,this.height)};c.Image.prototype.setPixelData=
function(a){this.context.putImageData(a,0,0)};c.Image.prototype.setWidth=function(a){this.width=a;this.canvasElement.width=this.width;this.context=this.canvasElement.getContext("2d")};c.Image.prototype.setHeight=function(a){this.height=a;this.canvasElement.height=this.height;this.context=this.canvasElement.getContext("2d")};c.Image.prototype.setImage=function(a,b){if(!(typeof a=="undefined"||a==null)){var c=this;if(a instanceof Image||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement){this.image=
a;this.width=a.width;this.height=a.height;this.canvasElement.width=this.width;this.canvasElement.height=this.height;this.context=this.canvasElement.getContext("2d");this.context.drawImage(this.image,0,0);if(a instanceof Image)this.type="image";if(a instanceof HTMLCanvasElement)this.type="canvas";if(a instanceof HTMLVideoElement)this.type="video"}else this.image=new Image,this.type="image-url",this.image.onload=function(){c.width=c.image.width;c.height=c.image.height;c.canvasElement.width=c.width;
c.canvasElement.height=c.height;c.context=c.canvasElement.getContext("2d");c.context.drawImage(c.image,0,0);typeof b!="undefined"&&b.call(c)},this.image.src=a;this.image.crossOrigin=""}}})(FILTER);
(function(c){c.ColorMatrixFilter=function(a,b){this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this.image=a;typeof b!="undefined"&&this.concat(b)};c.ColorMatrixFilter.prototype=new c.Filter;c.ColorMatrixFilter.prototype.constructor=c.ColorMatrixFilter;c.ColorMatrixFilter.prototype.concat=function(a){var b=[],c=0,d,e;for(e=0;e<4;e++){for(d=0;d<5;d++)b[c+d]=a[c]*this.matrix[d]+a[c+1]*this.matrix[d+5]+a[c+2]*this.matrix[d+10]+a[c+3]*this.matrix[d+15]+(d==4?a[c+4]:0);c+=5}this.matrix=b};c.ColorMatrixFilter.prototype.apply=
function(){for(var a=this.image.getPixelData(),b=a.data,c=this.matrix,d=0;d<b.length;d+=4){var e=[b[d],b[d+1],b[d+2],b[d+3]];b[d]=c[0]*e[0]+c[1]*e[1]+c[2]*e[2]+c[3]*e[3]+c[4];b[d+1]=c[5]*e[0]+c[6]*e[1]+c[7]*e[2]+c[8]*e[3]+c[9];b[d+2]=c[10]*e[0]+c[11]*e[1]+c[12]*e[2]+c[13]*e[3]+c[14];b[d+3]=c[15]*e[0]+c[16]*e[1]+c[17]*e[2]+c[18]*e[3]+c[19]}this.image.setPixelData(a)};c.LUMA={};c.LUMA.R=0.212671;c.LUMA.G=0.71516;c.LUMA.B=0.072169;c.ColorMatrixFilter.prototype.grayscale=function(){var a=c.LUMA.R,b=c.LUMA.G,
f=c.LUMA.B;this.concat([a,b,f,0,0,a,b,f,0,0,a,b,f,0,0,0,0,0,1,0]);return this};c.ColorMatrixFilter.prototype.desaturate=function(){this.concat([c.LUMA.R,c.LUMA.G,c.LUMA.B,0,0,c.LUMA.R,c.LUMA.G,c.LUMA.B,0,0,c.LUMA.R,c.LUMA.G,c.LUMA.B,0,0,0,0,0,1,0]);return this};c.ColorMatrixFilter.prototype.colorize=function(a,b){var f,d,e,h;typeof b=="undefined"&&(b=1);f=(a>>16&255)/255;d=(a>>8&255)/255;e=(a&255)/255;h=1-b;this.concat([h+b*f*c.LUMA.R,b*f*c.LUMA.G,b*f*c.LUMA.B,0,0,b*d*c.LUMA.R,h+b*d*c.LUMA.G,b*d*
c.LUMA.B,0,0,b*e*c.LUMA.R,b*e*c.LUMA.G,h+b*e*c.LUMA.B,0,0,0,0,0,1,0]);return this};c.ColorMatrixFilter.prototype.invert=function(){this.concat([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]);return this};c.ColorMatrixFilter.prototype.saturation=function(a){var b,f,d;b=1-a;f=b*c.LUMA.R;d=b*c.LUMA.G;b*=c.LUMA.B;this.concat([f+a,d,b,0,0,f,d+a,b,0,0,f,d,b+a,0,0,0,0,0,1,0]);return this};c.ColorMatrixFilter.prototype.contrast=function(a,b,c){typeof b=="undefined"&&(b=a);typeof c=="undefined"&&(c=a);
a+=1;b+=1;c+=1;this.concat([a,0,0,0,128*(1-a),0,b,0,0,128*(1-b),0,0,c,0,128*(1-c),0,0,0,1,0]);return this};c.ColorMatrixFilter.prototype.brightness=function(a,b,c){typeof b=="undefined"&&(b=a);typeof c=="undefined"&&(c=a);this.concat([1,0,0,0,a,0,1,0,0,b,0,0,1,0,c,0,0,0,1,0]);return this};c.ColorMatrixFilter.prototype.adjustHue=function(a){a*=Math.PI/180;var b=Math.cos(a),a=Math.sin(a);this.concat([c.LUMA.R+b*(1-c.LUMA.R)+a*-c.LUMA.R,c.LUMA.G+b*-c.LUMA.G+a*-c.LUMA.G,c.LUMA.B+b*-c.LUMA.B+a*(1-c.LUMA.B),
0,0,c.LUMA.R+b*-c.LUMA.R+a*0.143,c.LUMA.G+b*(1-c.LUMA.G)+a*0.14,c.LUMA.B+b*-c.LUMA.B+a*-0.283,0,0,c.LUMA.R+b*-c.LUMA.R+a*-(1-c.LUMA.R),c.LUMA.G+b*-c.LUMA.G+a*c.LUMA.G,c.LUMA.B+b*(1-c.LUMA.B)+a*c.LUMA.B,0,0,0,0,0,1,0]);return this};c.ColorMatrixFilter.prototype.blend=function(a,b){for(var c=1-b,d=0;d<20;)this.matrix[d]=c*this.matrix[d]+b*a.matrix[d],d++};c.ColorMatrixFilter.prototype.average=function(a,b,c){typeof a=="undefined"&&(a=1/3);typeof b=="undefined"&&(b=1/3);typeof c=="undefined"&&(c=1/3);
this.concat([a,b,c,0,0,a,b,c,0,0,a,b,c,0,0,0,0,0,1,0])};c.ColorMatrixFilter.prototype.threshold=function(a,b){typeof b=="undefined"&&(b=256);this.concat([c.LUMA.R*b,c.LUMA.G*b,c.LUMA.B*b,0,-(b-1)*a,c.LUMA.R*b,c.LUMA.G*b,c.LUMA.B*b,0,-(b-1)*a,c.LUMA.R*b,c.LUMA.G*b,c.LUMA.B*b,0,-(b-1)*a,0,0,0,1,0])};c.ColorMatrixFilter.prototype.threshold_rgb=function(a,b){typeof b=="undefined"&&(b=256);this.concat([b,0,0,0,-(b-1)*a,0,b,0,0,-(b-1)*a,0,0,b,0,-(b-1)*a,0,0,0,1,0])};c.ColorMatrixFilter.prototype.threshold_alpha=
function(a,b){typeof a=="undefined"&&(a=0.5);typeof b=="undefined"&&(b=256);this.concat([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,b,-b*a])}})(FILTER);
(function(c){c.ConvolutionMatrixFilter=function(a,b,c){this.image=a;if(typeof b!="undefined")this.weights=b;this.opaque=!0;if(typeof c!="undefined")this.opaque=c};c.ConvolutionMatrixFilter.prototype=new c.Filter;c.ConvolutionMatrixFilter.prototype.constructor=c.ConvolutionMatrixFilter;c.ConvolutionMatrixFilter.prototype.apply=function(){for(var a=Math.round(Math.sqrt(this.weights.length)),b=Math.floor(a/2),c=this.image.getPixelData(),d=c.data,e=c.width,c=c.height,h=this.image.clone().getPixelData(),
o=this.opaque?1:0,r=0;r<c;r++)for(var v=0;v<e;v++){for(var C=r,A=v,w=(r*e+v)*4,x=0,B=0,D=0,s=0,t=0;t<a;t++)for(var z=0;z<a;z++){var j=C+t-b,k=A+z-b;j>=0&&j<c&&k>=0&&k<e&&(j=(j*e+k)*4,k=this.weights[t*a+z],x+=d[j]*k,B+=d[j+1]*k,D+=d[j+2]*k,s+=d[j+3]*k)}h.data[w]=x;h.data[w+1]=B;h.data[w+2]=D;h.data[w+3]=s+o*(255-s)}this.image.setPixelData(h)};c.ConvolutionMatrixFilter.prototype.blur=function(){var a=1/9;this.weights=[a,a,a,a,a,a,a,a,a];return this};c.ConvolutionMatrixFilter.prototype.blur4=function(){this.weights=
[0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625];return this};c.ConvolutionMatrixFilter.prototype.sharpen=function(){this.weights=[-1,-1,-1,-1,9,-1,-1,-1,-1];return this};c.ConvolutionMatrixFilter.prototype.gauss=function(){this.weights=[0.0625,0.125,0.0625,0.125,0.25,0.125,0.0625,0.125,0.0625];return this};c.ConvolutionMatrixFilter.prototype.laplace=function(){this.weights=[0,1,0,1,-4,1,0,1,0];return this};c.ConvolutionMatrixFilter.prototype.emboss=
function(){this.weights=[-2,-1,0,-1,1,1,0,1,2];return this};c.ConvolutionMatrixFilter.prototype.edge=function(){this.weights=[0,1,0,1,-4,1,0,1,0];return this};c.ConvolutionMatrixFilter.prototype.motionblur=function(a){var b=1/9;this.weights=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];if(a==0)for(a=0;a<9;a++)this.weights[36+a]=b;else if(a==2)for(a=0;a<9;a++)this.weights[9*a+5]=b;
else if(a==1)for(a=0;a<9;a++)this.weights[9*Math.round(a)+Math.round(a)]=b;return this}})(FILTER);
(function(c){c.CHANNEL={};c.CHANNEL.RED=0;c.CHANNEL.GREEN=1;c.CHANNEL_BLUE=2;c.CHANNEL.ALPHA=3;c.MODE={};c.MODE.IGNORE=0;c.MODE.WRAP=1;c.MODE.CLAMP=2;c.MODE.COLOR=4;c.DisplacementMapFilter=function(a,b){this.scaleY=this.scaleX=1;this.color=this.componentY=this.componentX=this.startY=this.startX=0;this.mode=c.MODE.CLAMP;this.image=a;this.map=b};c.DisplacementMapFilter.prototype=new c.Filter;c.DisplacementMapFilter.prototype.constructor=c.DisplacementMapFilter;c.DisplacementMapFilter.prototype.apply=
function(){var a=this.image.getPixelData(),b=a.width,f=a.height,d=this.map.clone().getPixelData(),e=d.data,h=d.width,o=d.height,d=this.image.clone().getPixelData(),r=this.scaleX/256,v=this.scaleY/256,C=this.color>>24&255,A=this.color>>16&255,w=this.color>>8&255,x=this.color&255,B=Math.min(h,b),o=Math.min(o,f),D=Math.floor(this.startY),s=Math.floor(this.startX),t=this.componentX,z=this.componentY,j,k,p,y,i,E,J=this.mode;for(E=0;E<o;E++)for(i=0;i<B;i++)if(k=E+D,j=i+s,!(k<0||k>=f||j<0||j>=b)){p=(k*b+
j)*4;y=(E*h+i)*4;k+=Math.floor((e[y+z]-128)*v);j+=Math.floor((e[y+t]-128)*r);if(k>=f||k<0||j>=b||j<0)switch(J){case c.MODE.IGNORE:continue;case c.MODE.COLOR:d.data[p]=A;d.data[p+1]=w;d.data[p+2]=x;d.data[p+3]=C;continue;case c.MODE.WRAP:k>=f&&(k-=f);k<0&&(k+=f);j>=b&&(j-=b);j<0&&(j+=b);break;default:k>=f&&(k=f-1),k<0&&(k=0),j>=b&&(j=b-1),j<0&&(j=0)}j=(k*b+j)*4;d.data[p]=a.data[j];d.data[p+1]=a.data[j+1];d.data[p+2]=a.data[j+2];d.data[p+3]=a.data[j+3]}this.image.setPixelData(d)}})(FILTER);
(function(c){c.SobelFilter=function(a){this.image=a};c.SobelFilter.prototype=new c.Filter;c.SobelFilter.prototype.constructor=c.SobelFilter;c.SobelFilter.prototype.apply=function(){(new c.ColorMatrixFilter(this.image)).grayscale().apply();var a=this.image.getPixelData();(new c.ConvolutionMatrixFilter(this.image,[-1,0,1,-2,0,2,-1,0,1])).apply();var b=this.image.getPixelData();this.image.setPixelData(a);(new c.ConvolutionMatrixFilter(this.image,[-1,-2,-1,0,0,0,1,2,1])).apply();for(var f=this.image.getPixelData(),
d=[],e=0;e<a.data.length;e+=4){var h=Math.abs(b.data[e]);d[e]=h;var o=Math.abs(f.data[e]);d[e+1]=o;d[e+2]=(h+o)/4;d[e+3]=255}a=this.image.getPixelData();for(e=0;e<a.data.length;e++)a.data[e]=d[e];this.image.setPixelData(a,0,0)}})(FILTER);
