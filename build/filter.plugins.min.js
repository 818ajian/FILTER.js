/**
*
*   FILTER.js Plugins
*   @version: 0.9.6
*   @dependencies: Filter.js
*
*   JavaScript Image Processing Library (Plugins)
*   https://github.com/foo123/FILTER.js
*
**/!function(e,n){"use strict";"object"==typeof module&&module.exports?module.exports=n.call(e,module.$deps&&module.$deps.FILTER||require("./FILTER".toLowerCase())):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified("FILTER_PLUGINS")?define("FILTER_PLUGINS",["module","FILTER"],function(r,t){return n.moduleUri=r.uri,n.call(e,t),t}):(n.call(e,e.FILTER)||1)&&"function"==typeof define&&define.amd&&define(function(){return e.FILTER})}(this,function e(n){"use strict";var r=n.getPath(e.moduleUri);return!function(e){var n=e._notSupportClamp,t=Math.random;e.Create({name:"NoiseFilter",min:-127,max:127,init:function(e,n){var r=this;r.min=e||-127,r.max=n||127},path:r,serialize:function(){var e=this;return{min:e.min,max:e.max}},unserialize:function(e){var n=this;return n.min=e.min,n.max=e.max,n},apply:function(e,r,a){var i=this;if(!i._isOn)return e;var o,l,s,c,u,f,h,d,p=i.max-i.min,y=i.min,m=e.length;if(n)for(o=0;m>o;o+=4)s=e[o],c=e[o+1],u=e[o+2],l=p*t()+y,f=s+l,h=c+l,d=u+l,0>f?f=0:f>255&&(f=255),0>h?h=0:h>255&&(h=255),0>d?d=0:d>255&&(d=255),e[o]=0|f,e[o+1]=0|h,e[o+2]=0|d;else for(o=0;m>o;o+=4)s=e[o],c=e[o+1],u=e[o+2],l=p*t()+y,f=s+l,h=c+l,d=u+l,e[o]=0|f,e[o+1]=0|h,e[o+2]=0|d;return e}})}(n),!function(e){var n=e.Util.Image.perlin,t=e.MODE;e.Create({name:"PerlinNoiseFilter",mode:t.GRAY,_baseX:1,_baseY:1,_octaves:1,_offsets:null,_seed:0,_stitch:!1,_fractal:!0,_perlin:!1,path:r,init:function(e,n,r,a,i,o,l,s){var c=this;c.mode=t.GRAY,c._baseX=e||1,c._baseY=n||1,c._seed=l||0,c._stitch=!!a,c._fractal=!1!==i,c._perlin=!!s,c.octaves(r||1,o)},seed:function(e){var n=this;return n._seed=e||0,n},octaves:function(e,n){var r=this;for(r._octaves=e||1,r._offsets=n?n.slice(0):[];r._offsets.length<r._octaves;)r._offsets.push([0,0]);return r},seamless:function(e){return arguments.length||(e=!0),this._stitch=!!e,this},colors:function(e){return arguments.length||(e=!0),this.mode=e?t.COLOR:t.GRAY,this},turbulence:function(e){return arguments.length||(e=!0),this._fractal=!e,this},simplex:function(){return this._perlin=!1,this},perlin:function(){return this._perlin=!0,this},serialize:function(){var e=this;return{_baseX:e._baseX,_baseY:e._baseY,_octaves:e._octaves,_offsets:e._offsets,_seed:e._seed||0,_stitch:e._stitch,_fractal:e._fractal,_perlin:e._perlin}},unserialize:function(e){var n=this;return n._baseX=e._baseX,n._baseY=e._baseY,n._octaves=e._octaves,n._offsets=e._offsets,n._seed=e._seed||0,n._stitch=e._stitch,n._fractal=e._fractal,n._perlin=e._perlin,n},apply:function(e,r,a){var i=this;return n?(i._seed&&(n.seed(i._seed),i._seed=0),n(e,r,a,i._stitch,t.COLOR!==i.mode,i._baseX,i._baseY,i._octaves,i._offsets,1,.5,i._perlin)):e}})}(n),!function(e,n){var t=e.Color.Gradient,a=e.MODE,i=e.Util.Array.typed,o=Math.floor;e.Create({name:"GradientFilter",colors:null,stops:null,angle:0,centerX:0,centerY:0,radiusX:1,radiusY:1,path:r,dispose:function(){var e=this;return e.colors=null,e.stops=null,e.angle=null,e.centerX=null,e.centerY=null,e.radiusX=null,e.radiusY=null,e.$super("dispose"),e},setColors:function(e,n){var r=this;if(e&&e.length){var a=t.stops(e,n);r.colors=a[0],r.stops=a[1]}return r},serialize:function(){var e=this;return{angle:e.angle,centerX:e.centerX,centerY:e.centerY,radiusX:e.radiusX,radiusY:e.radiusY,colors:e.colors,stops:e.stops}},unserialize:function(e){var n=this;return n.angle=e.angle||0,n.centerX=e.centerX||0,n.centerY=e.centerY||0,n.radiusX=e.radiusX||1,n.radiusY=e.radiusY||1,n.colors=i(e.colors,Array),n.stops=i(e.stops,Array),n},linear:function(e,n,r){var t=this;return t.mode=a.LINEAR,t.setColors(e,n),t.angle=r||0,t},radial:function(e,n,r,t,i,o){var l=this;return l.mode=a.RADIAL,l.setColors(e,n),l.centerX=r||0,l.centerY=t||0,l.radiusX=i||1,l.radiusY=o||1,l},apply:function(e,n,r){var i=this;return i.colors?a.RADIAL===i.mode?t.radial(e,n,r,i.colors,i.stops,o((i.centerX||0)*(n-1)),o((i.centerY||0)*(r-1)),i.radiusX,i.radiusY,t.interpolate):t.linear(e,n,r,i.colors,i.stops,i.angle,t.interpolate):e}})}(n),!function(e){var n=Math.min,t=Math.floor,a=e.CHANNEL,i=e.MODE;e.Create({name:"ChannelCopyFilter",srcChannel:a.R,dstChannel:a.R,centerX:0,centerY:0,color:0,hasInputs:!0,path:r,init:function(e,n,r,t,i){var o=this;o.srcChannel=e||a.R,o.dstChannel=n||a.R,o.centerX=r||0,o.centerY=t||0,o.color=i||0},dispose:function(){var e=this;return e.srcChannel=null,e.dstChannel=null,e.centerX=null,e.centerY=null,e.color=null,e.$super("dispose"),e},serialize:function(){var e=this;return{srcChannel:e.srcChannel,dstChannel:e.dstChannel,centerX:e.centerX,centerY:e.centerY,color:e.color}},unserialize:function(e){var n=this;return n.srcChannel=e.srcChannel,n.dstChannel=e.dstChannel,n.centerX=e.centerX,n.centerY=e.centerY,n.color=e.color,n},apply:function(e,r,a){var o,l=this;if(o=l.input("source"),!o)return e;var s,c,u,f,h,d,p,y,m,v,_=o[0],g=o[1],C=o[2],b=e.length,Y=(_.length,l.srcChannel),w=l.dstChannel,X=l.centerX||0,I=l.centerY||0,x=g>>>1,A=C>>>1,M=n(r,g),z=n(a,C),S=l.color||0,R=l.mode,L=i.COLOR32,F=i.COLOR8,O=i.COLORMASK32,T=i.COLORMASK8;for(L===R||O===R?(v=S>>>24&255,p=S>>>16&255,y=S>>>8&255,m=255&S):F!==R&&T!==R||(S&=255),X=t(X*(r-1))-x,I=t(I*(a-1))-A,c=0,u=0,s=0;b>s;s+=4,c++)c>=r&&(c=0,u++),h=c-X,d=u-I,0>h||h>=M||0>d||d>=z?L===R?(e[s]=p,e[s+1]=y,e[s+2]=m,e[s+3]=v):O===R?(e[s]=p&e[s],e[s+1]=y&e[s+1],e[s+2]=m&e[s+2],e[s+3]=v&e[s+3]):F===R?e[s+w]=S:T===R&&(e[s+w]=S&e[s+Y]):(f=h+d*g<<2,e[s+w]=_[f+Y]);return e}})}(n),!function(e){var n=e._notSupportClamp,t=e.Array32F,a=e.MODE,i=Math.min,o=Math.max;e.Create({name:"HistogramEqualizeFilter",path:r,mode:a.INTENSITY,init:function(e){var n=this;n.mode=e||a.INTENSITY},_apply_rgb:function(e,r,a){var l,s,c,u,f,h,d,p,y,m,v,_,g,C,b,Y,w=0,X=0,I=0,x=255,A=255,M=255,z=e.length,S=z>>>2;for(d=new t(256),p=new t(256),y=new t(256),Y=0;z>Y;Y+=4)l=e[Y],s=e[Y+1],c=e[Y+2],d[l]++,p[s]++,y[c]++,w=o(l,w),X=o(s,X),I=o(c,I),x=i(l,x),A=i(s,A),M=i(c,M);for(m=v=_=0,Y=0;256>Y;Y+=32)m+=d[Y],d[Y]=m,m+=d[Y+1],d[Y+1]=m,m+=d[Y+2],d[Y+2]=m,m+=d[Y+3],d[Y+3]=m,m+=d[Y+4],d[Y+4]=m,m+=d[Y+5],d[Y+5]=m,m+=d[Y+6],d[Y+6]=m,m+=d[Y+7],d[Y+7]=m,m+=d[Y+8],d[Y+8]=m,m+=d[Y+9],d[Y+9]=m,m+=d[Y+10],d[Y+10]=m,m+=d[Y+11],d[Y+11]=m,m+=d[Y+12],d[Y+12]=m,m+=d[Y+13],d[Y+13]=m,m+=d[Y+14],d[Y+14]=m,m+=d[Y+15],d[Y+15]=m,m+=d[Y+16],d[Y+16]=m,m+=d[Y+17],d[Y+17]=m,m+=d[Y+18],d[Y+18]=m,m+=d[Y+19],d[Y+19]=m,m+=d[Y+20],d[Y+20]=m,m+=d[Y+21],d[Y+21]=m,m+=d[Y+22],d[Y+22]=m,m+=d[Y+23],d[Y+23]=m,m+=d[Y+24],d[Y+24]=m,m+=d[Y+25],d[Y+25]=m,m+=d[Y+26],d[Y+26]=m,m+=d[Y+27],d[Y+27]=m,m+=d[Y+28],d[Y+28]=m,m+=d[Y+29],d[Y+29]=m,m+=d[Y+30],d[Y+30]=m,m+=d[Y+31],d[Y+31]=m,v+=p[Y],p[Y]=v,v+=p[Y+1],p[Y+1]=v,v+=p[Y+2],p[Y+2]=v,v+=p[Y+3],p[Y+3]=v,v+=p[Y+4],p[Y+4]=v,v+=p[Y+5],p[Y+5]=v,v+=p[Y+6],p[Y+6]=v,v+=p[Y+7],p[Y+7]=v,v+=p[Y+8],p[Y+8]=v,v+=p[Y+9],p[Y+9]=v,v+=p[Y+10],p[Y+10]=v,v+=p[Y+11],p[Y+11]=v,v+=p[Y+12],p[Y+12]=v,v+=p[Y+13],p[Y+13]=v,v+=p[Y+14],p[Y+14]=v,v+=p[Y+15],p[Y+15]=v,v+=p[Y+16],p[Y+16]=v,v+=p[Y+17],p[Y+17]=v,v+=p[Y+18],p[Y+18]=v,v+=p[Y+19],p[Y+19]=v,v+=p[Y+20],p[Y+20]=v,v+=p[Y+21],p[Y+21]=v,v+=p[Y+22],p[Y+22]=v,v+=p[Y+23],p[Y+23]=v,v+=p[Y+24],p[Y+24]=v,v+=p[Y+25],p[Y+25]=v,v+=p[Y+26],p[Y+26]=v,v+=p[Y+27],p[Y+27]=v,v+=p[Y+28],p[Y+28]=v,v+=p[Y+29],p[Y+29]=v,v+=p[Y+30],p[Y+30]=v,v+=p[Y+31],p[Y+31]=v,_+=y[Y],y[Y]=_,_+=y[Y+1],y[Y+1]=_,_+=y[Y+2],y[Y+2]=_,_+=y[Y+3],y[Y+3]=_,_+=y[Y+4],y[Y+4]=_,_+=y[Y+5],y[Y+5]=_,_+=y[Y+6],y[Y+6]=_,_+=y[Y+7],y[Y+7]=_,_+=y[Y+8],y[Y+8]=_,_+=y[Y+9],y[Y+9]=_,_+=y[Y+10],y[Y+10]=_,_+=y[Y+11],y[Y+11]=_,_+=y[Y+12],y[Y+12]=_,_+=y[Y+13],y[Y+13]=_,_+=y[Y+14],y[Y+14]=_,_+=y[Y+15],y[Y+15]=_,_+=y[Y+16],y[Y+16]=_,_+=y[Y+17],y[Y+17]=_,_+=y[Y+18],y[Y+18]=_,_+=y[Y+19],y[Y+19]=_,_+=y[Y+20],y[Y+20]=_,_+=y[Y+21],y[Y+21]=_,_+=y[Y+22],y[Y+22]=_,_+=y[Y+23],y[Y+23]=_,_+=y[Y+24],y[Y+24]=_,_+=y[Y+25],y[Y+25]=_,_+=y[Y+26],y[Y+26]=_,_+=y[Y+27],y[Y+27]=_,_+=y[Y+28],y[Y+28]=_,_+=y[Y+29],y[Y+29]=_,_+=y[Y+30],y[Y+30]=_,_+=y[Y+31],y[Y+31]=_;if(u=(w-x)/S,f=(X-A)/S,h=(I-M)/S,n)for(Y=0;z>Y;Y+=4)l=e[Y],s=e[Y+1],c=e[Y+2],g=d[l]*u+x,C=p[s]*f+A,b=y[c]*h+M,g=0>g?0:g>255?255:g,C=0>C?0:C>255?255:C,b=0>b?0:b>255?255:b,e[Y]=~~g,e[Y+1]=~~C,e[Y+2]=~~b;else for(Y=0;z>Y;Y+=4)l=e[Y],s=e[Y+1],c=e[Y+2],g=d[l]*u+x,C=p[s]*f+A,b=y[c]*h+M,e[Y]=~~g,e[Y+1]=~~C,e[Y+2]=~~b;return e},apply:function(e,r,l){var s=this;if(a.RGB===s.mode)return s._apply_rgb(e,r,l);var c,u,f,h,d,p,y,m,v,_,g=0,C=255,b=e.length,Y=b>>>2,w=a.GRAY===s.mode;if(m=new t(256),w)for(_=0;b>_;_+=4)c=e[_],m[c]++,g=o(c,g),C=i(c,C);else for(_=0;b>_;_+=4)c=e[_],u=e[_+1],f=e[_+2],h=~~(0+.299*c+.587*u+.114*f),d=~~(128-.168736*c-.331264*u+.5*f),p=~~(128+.5*c-.418688*u-.081312*f),p=0>p?0:p>255?255:p,h=0>h?0:h>255?255:h,d=0>d?0:d>255?255:d,e[_]=p,e[_+1]=h,e[_+2]=d,m[h]++,g=o(h,g),C=i(h,C);for(v=0,_=0;256>_;_+=32)v+=m[_],m[_]=v,v+=m[_+1],m[_+1]=v,v+=m[_+2],m[_+2]=v,v+=m[_+3],m[_+3]=v,v+=m[_+4],m[_+4]=v,v+=m[_+5],m[_+5]=v,v+=m[_+6],m[_+6]=v,v+=m[_+7],m[_+7]=v,v+=m[_+8],m[_+8]=v,v+=m[_+9],m[_+9]=v,v+=m[_+10],m[_+10]=v,v+=m[_+11],m[_+11]=v,v+=m[_+12],m[_+12]=v,v+=m[_+13],m[_+13]=v,v+=m[_+14],m[_+14]=v,v+=m[_+15],m[_+15]=v,v+=m[_+16],m[_+16]=v,v+=m[_+17],m[_+17]=v,v+=m[_+18],m[_+18]=v,v+=m[_+19],m[_+19]=v,v+=m[_+20],m[_+20]=v,v+=m[_+21],m[_+21]=v,v+=m[_+22],m[_+22]=v,v+=m[_+23],m[_+23]=v,v+=m[_+24],m[_+24]=v,v+=m[_+25],m[_+25]=v,v+=m[_+26],m[_+26]=v,v+=m[_+27],m[_+27]=v,v+=m[_+28],m[_+28]=v,v+=m[_+29],m[_+29]=v,v+=m[_+30],m[_+30]=v,v+=m[_+31],m[_+31]=v;if(y=(g-C)/Y,n)if(w)for(_=0;b>_;_+=4)c=~~(m[e[_]]*y+C),c=0>c?0:c>255?255:c,e[_]=c,e[_+1]=c,e[_+2]=c;else for(_=0;b>_;_+=4)h=m[e[_+1]]*y+C,d=e[_+2],p=e[_],c=~~(h+1.402*(p-128)),u=~~(h-.34414*(d-128)-.71414*(p-128)),f=~~(h+1.772*(d-128)),c=0>c?0:c>255?255:c,u=0>u?0:u>255?255:u,f=0>f?0:f>255?255:f,e[_]=c,e[_+1]=u,e[_+2]=f;else if(w)for(_=0;b>_;_+=4)c=~~(m[e[_]]*y+C),e[_]=c,e[_+1]=c,e[_+2]=c;else for(_=0;b>_;_+=4)h=m[e[_+1]]*y+C,d=e[_+2],p=e[_],c=~~(h+1.402*(p-128)),u=~~(h-.34414*(d-128)-.71414*(p-128)),f=~~(h+1.772*(d-128)),e[_]=c,e[_+1]=u,e[_+2]=f;return e}})}(n),!function(e){var n=e.ImArray,t=Math.sqrt,a=Math.min,i=Math.max;t(3);e.Create({name:"PixelateFilter",scale:1,init:function(e){var n=this;n.scale=e||1},path:r,serialize:function(){var e=this;return{scale:e.scale}},unserialize:function(e){var n=this;return n.scale=e.scale,n},apply:function(e,r,i){var o=this;if(o.scale<=1)return e;o.scale>100&&(o.scale=100);var l,s,c,u,f,h,d,p,y,m,v,_,g,C,b,Y,w,X,I,x,A,M,z,S,R=e.length,L=R>>>2,F=r-1,O=L-r;for(l=new n(R),s=t(L)*o.scale*.01|0,c=s-1,u=r*c,C=b=Y=w=X=0,g=0;R>g;g+=4)I=C-Y,x=b-X,A=a(F,I+c),M=a(O,x+u),z=a(F,I+(.5*s|0)),S=a(O,x+(.5*s|0)*r),f=I+x<<2,h=I+M<<2,d=A+x<<2,p=A+M<<2,y=z+S<<2,m=.125*(e[f]+e[h]+e[d]+e[p]+4*e[y]),v=.125*(e[f+1]+e[h+1]+e[d+1]+e[p+1]+4*e[y+1]),_=.125*(e[f+2]+e[h+2]+e[d+2]+e[p+2]+4*e[y+2]),l[g]=0|m,l[g+1]=0|v,l[g+2]=0|_,l[g+3]=e[g+3],C++,Y++,C>=r&&(Y=0,C=0,w++,X+=r,b+=r,w>=s&&(w=0,X=0)),Y>=s&&(Y=0);return l}}),e.Create({name:"TriangularPixelateFilter",scale:1,init:function(e){var n=this;n.scale=e||1},path:r,serialize:function(){var e=this;return{scale:e.scale}},unserialize:function(e){var n=this;return n.scale=e.scale,n},apply:function(e,r,i){var o=this;if(o.scale<=1)return e;o.scale>100&&(o.scale=100);var l,s,c,u,f,h,d,p,y,m,v,_,g,C,b,Y,w,X,I,x,A,M,z,S=e.length,R=S>>>2,L=r-1,F=R-r;for(l=new n(S),s=t(R)*o.scale*.01|0,c=s-1,u=r*c,g=C=b=Y=w=0,_=0;S>_;_+=4)X=g-b,I=C-w,x=a(L,X+c),A=a(F,I+u),b+Y>c?(M=a(L,X+(.666*s|0)),z=a(F,I+(.5*s|0)*r),f=x+I<<2,h=x+A<<2,d=X+I<<2,p=M+z<<2):(M=a(L,X+(.333*s|0)),z=a(F,I+(.5*s|0)*r),f=X+I<<2,h=X+A<<2,d=x+I<<2,p=M+z<<2),y=.2*(e[f]+e[h]+e[d]+2*e[p]),m=.2*(e[f+1]+e[h+1]+e[d+1]+2*e[p+1]),v=.2*(e[f+2]+e[h+2]+e[d+2]+2*e[p+2]),l[_]=0|y,l[_+1]=0|m,l[_+2]=0|v,l[_+3]=e[_+3],g++,b++,g>=r&&(b=0,g=0,Y++,w+=r,C+=r,Y>=s&&(Y=0,w=0)),b>=s&&(b=0);return l}}),e.Create({name:"RhomboidPixelateFilter",scale:1,init:function(e){var n=this;n.scale=e||1},path:r,serialize:function(){var e=this;return{scale:e.scale}},unserialize:function(e){var n=this;return n.scale=e.scale,n},apply:function(e,r,o){var l=this;if(l.scale<=1)return e;l.scale>100&&(l.scale=100);var s,c,u,f,h,d,p,y,m,v,_,g,C,b,Y,w,X,I,x,A,M,z,S,R,L,F,O,T=e.length,E=T>>>2,N=r-1,P=E-r;for(s=new n(T),c=t(E)*l.scale*.007|0,u=2*c,f=r*c,h=2*f,d=.5*c|0,X=I=x=A=M=0,p=0,w=0;T>w;w+=4)p?x+A>u?(z=a(N,X-x+c),S=i(0,I-M)):x+c-A>c?(z=i(0,X-x),S=i(0,I-M-f)):(z=i(0,X-x-c),S=i(0,I-M)):x+c-A>u?(z=a(N,X-x+c),S=i(0,I-M-f)):x+A>c?(z=i(0,X-x),S=i(0,I-M)):(z=i(0,X-x-c),S=i(0,I-M-f)),R=a(N,z+u),L=a(P,S+h),F=a(N,z+c),O=a(P,S+f),y=z+S<<2,m=z+L<<2,v=R+S<<2,_=R+L<<2,g=F+O<<2,C=.125*(e[y]+e[m]+e[v]+e[_]+4*e[g]),b=.125*(e[y+1]+e[m+1]+e[v+1]+e[_+1]+4*e[g+1]),Y=.125*(e[y+2]+e[m+2]+e[v+2]+e[_+2]+4*e[g+2]),s[w]=0|C,s[w+1]=0|b,s[w+2]=0|Y,s[w+3]=e[w+3],X++,x++,X>=r&&(x=0,X=0,A++,M+=r,I+=r,A>=c&&(A=0,M=0,p=1-p)),x>=u&&(x=0);return s}})}(n),!function(e,n){var t=7/16,a=3/16,i=5/16,o=1/16,l=e.MODE,s=e.Array32F,c=e.Color.clamp,u=e.Color.intensity;e.Create({name:"HalftoneFilter",size:1,thresh:.4,mode:l.GRAY,init:function(e,n,r){var t=this;t.size=e||1,t.thresh=c(null==n?.4:n,0,1),t.mode=r||l.GRAY},path:r,threshold:function(e){return this.thresh=c(e,0,1),this},serialize:function(){var e=this;return{size:e.size,thresh:e.thresh}},unserialize:function(e){var n=this;return n.size=e.size,n.thresh=e.thresh,n},apply:function(e,n,r){var c,f,h,d,p,y,m,v,_,g,C,b,Y,w,X,I,x,A,M,z,S,R=this,L=e.length,F=L>>>2,O=new s(3*F),T=R.size,E=T*T,N=1/E,P=255*R.thresh,q=q<<1,G=l.RGB===R.mode,H=T*n,U=t,D=a,$=i,k=o;for(p=0,y=0,d=0;r>p;){if(g=C=b=0,G){for(m=0,v=0,_=0;T>v;)c=d+y+m+_<<2,f=3*(d+y+m+_),g+=e[c]+O[f],C+=e[c+1]+O[f+1],b+=e[c+2]+O[f+2],++m>=T&&(m=0,v++,_+=n);g*=N,C*=N,b*=N,h=u(g,C,b),h>P?(Y=0|g,w=0|C,X=0|b):(Y=0,w=0,X=0)}else{for(m=0,v=0,_=0;T>v;)c=d+y+m+_<<2,f=3*(d+y+m+_),g+=e[c]+O[f],++m>=T&&(m=0,v++,_+=n);h=g*N,h>P?(Y=255,w=255,X=255):(Y=0,w=0,X=0)}if(c=d+y<<2,I=e[c]-Y,x=e[c+1]-w,A=e[c+2]-X,n>d+T)for(M=U*I,z=U*x,S=U*A,m=T,v=0,_=0;T>v;)f=3*(d+y+m+_),O[f]+=M,O[f+1]+=z,O[f+2]+=S,++m>=q&&(m=T,v++,_+=n);if(r>p+T&&d>T)for(M=D*I,z=D*x,S=D*A,m=-T,v=T,_=0;q>v;)f=3*(d+y+m+_),O[f]+=M,O[f+1]+=z,O[f+2]+=S,++m>=0&&(m=-T,v++,_+=n);if(r>p+T)for(M=$*I,z=$*x,S=$*A,m=0,v=T,_=0;q>v;)f=3*(d+y+m+_),O[f]+=M,O[f+1]+=z,O[f+2]+=S,++m>=T&&(m=0,v++,_+=n);if(r>p+T&&n>d+T)for(M=k*I,z=k*x,S=k*A,m=T,v=T,_=0;q>v;)f=3*(d+y+m+_),O[f]+=M,O[f+1]+=z,O[f+2]+=S,++m>=q&&(m=T,v++,_+=n);for(m=0,v=0,_=0;T>v;)c=d+y+m+_<<2,e[c]=Y,e[c+1]=w,e[c+2]=X,++m>=T&&(m=0,v++,_+=n);d+=T,d>=n&&(d=0,p+=T,y+=H)}return e}})}(n),!function(e,n){var t=e.ImArray,a=e.Util.Filter.integral_convolution,i=e.MODE,o=new e.ConvolutionMatrix([1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9]);e.Create({name:"DropShadowFilter",offsetX:null,offsetY:null,color:0,opacity:1,quality:1,onlyShadow:!1,path:r,init:function(e,n,r,t,a,i){var o=this;o.offsetX=e||0,o.offsetY=n||0,o.color=r||0,o.opacity=null==t?1:+t,o.quality=0|(a||1),o.onlyShadow=!!i},dispose:function(){var e=this;return e.offsetX=null,e.offsetY=null,e.color=null,e.opacity=null,e.quality=null,e.onlyShadow=null,e.$super("dispose"),e},serialize:function(){var e=this;return{offsetX:e.offsetX,offsetY:e.offsetY,color:e.color,opacity:e.opacity,quality:e.quality,onlyShadow:e.onlyShadow}},unserialize:function(e){var n=this;return n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.color=e.color,n.opacity=e.opacity,n.quality=e.quality,n.onlyShadow=e.onlyShadow,n},apply:function(e,n,r){var l=this;if(!l._isOn)return e;var s,c,u,f,h,d,p,y,m,v,_,g=l.color||0,C=l.opacity,b=l.quality,Y=l.onlyShadow,w=l.offsetX||0,X=l.offsetY||0,I=e.length,x=I>>>2;if(0>C&&(C=0),C>1&&(C=1),0===C)return e;for(s=g>>>16&255,c=g>>>8&255,u=255&g,0>=b&&(b=1),b>3&&(b=3),_=new t(I),f=0;I>f;f+=4)v=e[f+3],v>0&&(_[f]=s,_[f+1]=c,_[f+2]=u,_[f+3]=C*v|0);if(_=a(s===c&&c===u?i.GRAY:i.RGB,_,n,r,2,o,null,3,3,1,0,b),X*=n,Y)for(h=0,d=0,m=0;I>m;m+=4,h++)h>=n&&(h=0,d+=n),p=h+w,y=d+X,0>p||p>=n||0>y||y>=x||(f=p+y<<2,e[f]=_[m],e[f+1]=_[m+1],e[f+2]=_[m+2],e[f+3]=_[m+3]);else for(h=0,d=0,m=0;I>m;m+=4,h++)h>=n&&(h=0,d+=n),p=h+w,y=d+X,0>p||p>=n||0>y||y>=x||(f=p+y<<2,v=e[f+3],C=_[m+3],255!==v&&0!==C&&(C/=255,s=e[f]+(_[m]-e[f])*C,c=e[f+1]+(_[m+1]-e[f+1])*C,u=e[f+2]+(_[m+2]-e[f+2])*C,e[f]=0|s,e[f+1]=0|c,e[f+2]=0|u));return e}})}(n),!function(e){var n=(Math.sqrt,Math.exp,Math.log),t=Math.abs,a=Math.floor,i=e._notSupportClamp,o=e.Array32F;e.Create({name:"BokehFilter",centerX:0,centerY:0,radius:10,amount:10,init:function(e,n,r,t){var a=this;a.centerX=e||0,a.centerY=n||0,a.radius=r||10,a.amount=t||10},path:r,serialize:function(){var e=this;return{centerX:e.centerX,centerY:e.centerY,radius:e.radius,amount:e.amount}},unserialize:function(e){var n=this;return n.centerX=e.centerX,n.centerY=e.centerY,n.radius=e.radius,n.amount=e.amount,n},apply:function(e,r,l){var s=this;if(!s._isOn)return e;var c,u,f,h,d,p,y,m,v,_,g,C,b,Y,w,X,I,x,A,M,z,S,R,L,F,O,T,E,N,P,q,G,H,U=e.length,D=s.centerX||0,$=s.centerY||0,k=s.radius,B=s.amount;if(0>=B)return e;for(c=U>>>2,P=0,q=r-1,G=0,H=c-r,D=a(D*(r-1)),$=a($*(l-1)),f=(c<<1)+c,y=(r<<1)+r,u=new o(f),m=0,v=0,_=0,h=d=p=0,_=0;r>_;_++,m+=4,v+=3)h+=e[m],d+=e[m+1],p+=e[m+2],u[v]=h,u[v+1]=d,u[v+2]=p;for(m=y+r,v=0,_=0,h=d=p=0,m=y+r;U>m;m+=4,v+=3,_++)_>=r&&(_=0,h=d=p=0),h+=e[m],d+=e[m+1],p+=e[m+2],u[v+y]=u[v]+h,u[v+y+1]=u[v+1]+d,u[v+y+2]=u[v+2]+p;for(_=0,g=0,C=0,m=0;U>m;m+=4,_++)_>=r&&(_=0,g++,C+=r),Y=_-D,w=g-$,b=t(Y)+t(w),X=b>k?0|n((b-k)*B):b/k+.5|0,X>0&&(I=X*r,x=.25/(X*X),A=_-X,M=C-I,z=_+X,S=C+I,P>A?A=P:z>q&&(z=q),G>M?M=G:S>H&&(S=H),R=A+M,O=z+S,L=z+M,F=A+S,R=(R<<1)+R,L=(L<<1)+L,F=(F<<1)+F,O=(O<<1)+O,T=x*(u[O]-u[L]-u[F]+u[R]),E=x*(u[O+1]-u[L+1]-u[F+1]+u[R+1]),N=x*(u[O+2]-u[L+2]-u[F+2]+u[R+2]),i&&(T=0>T?0:T>255?255:T,E=0>E?0:E>255?255:E,N=0>N?0:N>255?255:N),e[m]=0|T,e[m+1]=0|E,e[m+2]=0|N);return e}})}(n),!function(e){e.Create({name:"SeamlessTileFilter",type:2,init:function(e){var n=this;n.type=null==e?2:e||0},path:r,serialize:function(){var e=this;return{type:e.type}},unserialize:function(e){var n=this;return n.type=e.type,n},apply:function(n,r,t){var a,i,o,l,s,c,u,f,h,d,p,y,m,v,_,g=this,C=g.type,b=e.Interpolation.bilinear,Y=e.ImArray,w=e.Array8U,X=Math.sqrt;for(r!==t?n=b(n,r,t,y=r>t?r:t,y):y=r,m=Math.round(y/2),v=y*y,_=n.length,a=new Y(_),i=new Y(_),o=new w(v),f=0,h=0,d=0;_>d;d+=4,f++)f>=y&&(f=0,h++),p=(f+m)%y+(h+m)%y*y<<2,a[p]=n[d],a[p+1]=n[d+1],a[p+2]=n[d+2],a[p+3]=n[d+3];if(0===C)for(f=0,h=0;m>f;h++)h>=m&&(h=0,f++),u=255-255*X((f-m)*(f-m)+(h-m)*(h-m))/m,u=1>u?1:u>255?255:u,o[f+h*y]=u,o[f+(y-1-h)*y]=u,o[y-1-f+h*y]=u,o[y-1-f+(y-1-h)*y]=u;else if(1===C)for(f=0,h=0;m>f;h++)h>=m&&(h=0,f++),u=255-255*(m+f>m+h?(h-m)/m:(f-y/2)/m),u=1>u?1:u>255?255:u,o[f+h*y]=u,o[f+(y-1-h)*y]=u,o[y-1-f+h*y]=u,o[y-1-f+(y-1-h)*y]=u;else for(f=0,h=0;m>f;h++)h>=m&&(h=0,f++),u=255-255*(m+f>m+h?X((h-y)*(h-y)+(f-y)*(f-y))/(1.13*y):X((f-y)*(f-y)+(h-y)*(h-y))/(1.13*y)),u=1>u?1:u>255?255:u,o[f+h*y]=u,o[f+(y-1-h)*y]=u,o[y-1-f+h*y]=u,o[y-1-f+(y-1-h)*y]=u;for(h=0,f=0;y>h;f++)f>=y&&(f=0,h++),p=f+h*y,l=o[p],s=o[(f+m)%y+(h+m)%y*y],c=l+s,l/=c,s/=c,p<<=2,i[p]=~~(l*n[p]+s*a[p]),i[p+1]=~~(l*n[p+1]+s*a[p+1]),i[p+2]=~~(l*n[p+2]+s*a[p+2]),i[p+3]=n[p+3];return r!==t&&(i=b(i,y,y,r,t)),i}})}(n),!function(e){var n=(e.Util.Array.typed,Math.abs,Math.min,Math.max,Math.ceil,e.MODE),t=e.MachineLearning.connected_component;e.Create({name:"FloodFillFilter",x:0,y:0,color:null,border:null,tolerance:1e-6,path:r,init:function(e,n,r,t,a){var i=this;i.x=e||0,i.y=n||0,i.color=r||0,i.tolerance=null==t?1e-6:+t,i.border=null!=a?a||0:null},serialize:function(){var e=this;return{color:e.color,border:e.border,x:e.x,y:e.y,tolerance:e.tolerance}},unserialize:function(e){var n=this;return n.color=e.color,n.border=e.border,n.x=e.x,n.y=e.y,n.tolerance=e.tolerance,n},apply:function(e,n,r){var a,i,o,l,s,c,u,f,h,d,p,y,m,v,_,g,C,b,Y,w=this,X=w.color||0,I=w.x||0,x=w.y||0,A=w.border;if(0>I||I>=n||0>x||x>=r)return e;if(I<<=2,x=x*n<<2,m=I+x,l=e[m],s=e[m+1],c=e[m+2],a=X>>>16&255,i=X>>>8&255,o=255&X,null!=A){if(u=A>>>16&255,f=A>>>8&255,h=255&A,l===u&&s===f&&c===h)return e;l=u,s=f,c=h}else if(a===l&&i===s&&o===c)return e;for(v=[0,0,0,0],_=t(I,x,l,s,c,v,e,n,r,255*(w.tolerance>=1?.999:w.tolerance)|0,null!=A),g=v[0]>>>2,C=v[1]>>>2,b=v[2]>>2,Y=v[3]>>>2,d=g,p=C;Y>=p;)y=d+p,_[y>>>5]&1<<(31&y)&&(m=y<<2,e[m]=a,e[m+1]=i,e[m+2]=o),++d>b&&(d=g,p+=n);return e}}),e.Create({name:"PatternFillFilter",x:0,y:0,offsetX:0,offsetY:0,tolerance:1e-6,mode:n.TILE,border:null,hasInputs:!0,path:r,init:function(e,r,t,a,i,o,l,s){var c=this;c.x=e||0,c.y=r||0,c.offsetX=a||0,c.offsetY=i||0,t&&c.setInput("pattern",t),c.mode=o||n.TILE,c.tolerance=null==l?1e-6:+l,c.border=null!=s?s||0:null},dispose:function(){var e=this;return e.x=null,e.y=null,e.offsetX=null,e.offsetY=null,e.tolerance=null,e.border=null,e.$super("dispose"),e},serialize:function(){var e=this;return{x:e.x,y:e.y,offsetX:e.offsetX,offsetY:e.offsetY,tolerance:e.tolerance,border:e.border}},unserialize:function(e){var n=this;return n.x=e.x,n.y=e.y,n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.tolerance=e.tolerance,n.border=e.border,n},apply:function(e,r,a){var i,o=this,l=o.x||0,s=o.y||0;if(0>l||l>=r||0>s||s>=a)return e;if(i=o.input("pattern"),!i)return e;var c,u,f,h,d,p,y,m,v,_,g,C,b,Y,w,X,I,x,A,M,z,S=n.STRETCH,R=o.mode,L=i[0],F=i[1],O=i[2],T=o.offsetX||0,E=o.offsetY||0,N=o.border;if(l<<=2,s=s*r<<2,_=l+s,c=e[_],u=e[_+1],f=e[_+2],null!=N){if(h=N>>>16&255,d=N>>>8&255,p=255&N,c===h&&u===d&&f===p)return e;c=h,u=d,f=p}if(Y=[0,0,0,0],w=t(l,s,c,u,f,Y,e,r,a,255*(o.tolerance>=1?.999:o.tolerance)|0,null!=N),X=Y[0]>>>2,I=Y[1]>>>2,x=Y[2]>>>2,A=Y[3]>>>2,S===R)for(M=F/(x-X+1),z=O/(A-I+r),y=X,m=I;A>=m;)v=y+m,w[v>>>5]&1<<(31&v)&&(_=v<<2,C=M*(y-X)|0,b=z*(m-I)|0,g=C+b*F<<2,e[_]=L[g],e[_+1]=L[g+1],e[_+2]=L[g+2]),++y>x&&(y=X,m+=r);else for(0>T&&(T+=F),0>E&&(E+=O),y=X,m=I;A>=m;)v=y+m,w[v>>>5]&1<<(31&v)&&(_=v<<2,C=(y-X+T)%F,b=(m-I+E)%O,g=C+b*F<<2,e[_]=L[g],e[_+1]=L[g+1],e[_+2]=L[g+2]),++y>x&&(y=X,m+=r);return e}})}(n),!function(e,n){var t=e.Array32F,a=e.MODE,i=e.Color.hue,o=e.Color.intensity,l=Math.min,s=Math.max,c=Math.cos,u=e.CONST.toRad,f=e.MachineLearning.connected_components;e.Create({name:"ConnectedComponentsFilter",connectivity:4,tolerance:1e-6,mode:a.COLOR,color:null,invert:!1,box:null,init:function(e,n,r,t,i){var o=this;o.connectivity=8===e?8:4,o.tolerance=null==n?1e-6:+n,o.mode=r||a.COLOR,o.color=null==t?null:+t,o.invert=!!i},path:r,serialize:function(){var e=this;return{connectivity:e.connectivity,tolerance:e.tolerance,color:e.color,invert:e.invert}},unserialize:function(e){var n=this;return n.connectivity=e.connectivity,n.tolerance=e.tolerance,n.color=e.color,n.invert=e.invert,n},apply:function(e,n,r){var h,d,p=this,y=e.length,m=y>>>2,v=p.mode||a.COLOR,_=p.color,g=l(.999,s(0,p.tolerance||0)),C=new t(m);if(a.HUE===v)for(null!=_&&(_=c(u*_)),h=0,d=0;y>h;h+=4,d++)C[d]=0===e[h+3]?-1e4:c(u*i(e[h],e[h+1],e[h+2]));else if(a.INTENSITY===v)for(g*=255,h=0,d=0;y>h;h+=4,d++)C[d]=0===e[h+3]?-1e4:o(e[h],e[h+1],e[h+2]);else for(g=255*g|0,g=g<<16|g<<8|g,h=0,d=0;y>h;h+=4,d++)C[d]=0===e[h+3]?-4294967295:e[h]<<16|e[h+1]<<8|e[h+2];return f(2,e,C,n,r,p.connectivity,p.invert,g,_)}})}(n),!function(e){var n=e.Util.Filter.gradient,t=100,a=1e3,i=t*a,o=Math.round;e.Create({name:"CannyEdgesFilter",low:2.5,high:7.5,lowpass:!0,path:r,init:function(e,n,r){var t=this;t.low=arguments.length<1?2.5:+e,t.high=arguments.length<2?7.5:+n,t.lowpass=arguments.length<3?!0:!!r},thresholds:function(e,n,r){var t=this;return t.low=+e,t.high=+n,arguments.length>2&&(t.lowpass=!!r),t},serialize:function(){var e=this;return{low:e.low,high:e.high,lowpass:e.lowpass}},unserialize:function(e){var n=this;return n.low=e.low,n.high=e.high,n.lowpass=e.lowpass,n},apply:function(e,r,l){var s=this;return n(e,r,l,2,0,s.lowpass,0,o(s.low*t),o(s.high*t),t,a,i)}})}(n),!function(e,n){function t(e,n,r,t,a,i,o,l,s,c,u,f,p,y,_,g,C){var b,Y,w,X,I,x,A,M,z,S,R,L,F,O,T,E,N,P,q,G,H,U,D,$,k,B,j,K,W,J,Q,V,Z,ee,q,ne,re,te,ae,ie,oe,le,se,ce,ue,fe,he,de,pe,ye,me,ve,_e,ge=null!=_,Ce=i-t+1,be=o-a+1,Ye=Ce*be,we=Ye-1,Xe=l.stages,Ie=Xe.length,xe=l.size1,Ae=l.size2,Me=h(Ce/xe,be/Ae),ze=t,Se=a;for(G=0,H=Ce-1,U=0,D=Ye-Ce,b=s,b=s;Me>=b;b*=c)for(X=b*xe|0,Y=X*u|0,I=b*Ae|0,w=I*u|0,S=I*Ce,R=w*Ce,x=Se*R,E=Ce-X,N=be-I,$=X*I,k=1/$,M=Se,z=x;N>M;M+=w,z+=R)for(A=ze;E>A;A+=Y)if(L=A-1+z-Ce,F=L+X,O=L+S,T=O+X,L=0>L?0:L>we?we:L,F=0>F?0:F>we?we:F,O=0>O?0:O>we?we:O,T=0>T?0:T>we?we:T,!(ge&&(W=k*(_[T]-_[O]-_[F]+_[L]),g>W||W>C))){for(B=k*(f[T]-f[O]-f[F]+f[L]),j=k*(y[T]-y[O]-y[F]+y[L]),K=j-B*B,K=K>1?d(K):K,J=!1,P=0;Ie>P;P++){for(Q=Xe[P],V=Q.thres,Z=Q.trees,ee=Z.length,_e=0,q=0;ee>q;q++)for(re=Z[q].feats,ne=0;;){if(te=re[ne],ae=te.rects,ie=ae.length,oe=te.thres,le=0,te.tilt)for(se=0;ie>se;se++)ce=ae[se],ue=A+b*ce[0]|0,fe=(M-1+b*ce[1]|0)*Ce,he=A+b*(ce[0]+ce[2])|0,de=(M-1+b*(ce[1]+ce[2])|0)*Ce,pe=A+b*(ce[0]-ce[3])|0,ye=(M-1+b*(ce[1]+ce[3])|0)*Ce,me=A+b*(ce[0]+ce[2]-ce[3])|0,ve=(M-1+b*(ce[1]+ce[2]+ce[3])|0)*Ce,ue=G>ue?G:ue>H?H:ue,he=G>he?G:he>H?H:he,pe=G>pe?G:pe>H?H:pe,me=G>me?G:me>H?H:me,fe=U>fe?U:fe>D?D:fe,de=U>de?U:de>D?D:de,ye=U>ye?U:ye>D?D:ye,ve=U>ve?U:ve>D?D:ve,le+=ce[4]*(p[me+ve]-p[pe+ye]-p[he+de]+p[ue+fe]);else for(se=0;ie>se;se++)ce=ae[se],ue=A-1+b*ce[0]|0,he=A-1+b*(ce[0]+ce[2])|0,fe=Ce*(M-1+b*ce[1]|0),de=Ce*(M-1+b*(ce[1]+ce[3])|0),ue=G>ue?G:ue>H?H:ue,he=G>he?G:he>H?H:he,fe=U>fe?U:fe>D?D:fe,de=U>de?U:de>D?D:de,le+=ce[4]*(f[he+de]-f[ue+de]-f[he+fe]+f[ue+fe]);if(oe*K>le*k){if(te.has_l){_e+=te.l_val;break}ne=te.l_node}else{if(te.has_r){_e+=te.r_val;break}ne=te.r_node}}if(J=_e>V,!J)break}J&&(e.count===e.length&&v.apply(e,new Array(m)),e[e.count++]=[A,M,X,I])}}function a(e,n,r){var t=f(n[2],e[2])*r,a=f(n[3],e[3])*r;return u(e[0]-n[0])<=t&&u(e[1]-n[1])<=a&&u(e[2]-n[2])<=t&&u(e[3]-n[3])<=a}function i(e,n){return e.x1>=n.x1&&e.y1>=n.y1&&e.x2<=n.x2&&e.y2<=n.y2}function o(e){e.x1=e.x1+.5|0,e.y1=e.y1+.5|0,e.x2=e.x2+.5|0,e.y2=e.y2+.5|0}function l(e,n){return n.area-e.area}function s(e,n,r){var t,s,c,u,f,h,d,p,y,m,v,_=e.length,g=new Array(_),C=[],b=0,Y=!1;for(c=0;_>c;c++)g[c]=0;for(c=0;_>c;c++){for(Y=!1,u=0;c>u;u++)a(e[u],e[c],r)&&(Y=!0,g[c]=g[u]);Y||(g[c]=b,b++)}for(t=new Array(b),s=new Array(b),c=0;b>c;c++)t[c]=0,s[c]=[0,0,0,0];for(c=0;_>c;c++)d=g[c],t[d]++,s[d][0]+=e[c][0],s[d][1]+=e[c][1],s[d][2]+=e[c][2],s[d][3]+=e[c][3];for(c=0;b>c;c++)f=t[c],f>=n&&(h=1/(f+f),p=h*(2*s[c][0]+f),y=h*(2*s[c][1]+f),m=h*(2*s[c][2]+f),v=h*(2*s[c][3]+f),C.push({x1:p,y1:y,x2:p+m-1,y2:y+v-1,x:p,y:y,width:m,height:v,area:0,inside:0}));for(_=C.length,c=0;_>c;c++)for(u=c+1;_>u;u++)!C[c].inside&&i(C[c],C[u])?C[c].inside=1:!C[u].inside&&i(C[u],C[c])&&(C[u].inside=1);for(c=_;--c>=0;)C[c].inside?C.splice(c,1):(o(C[c]),C[c].area=C[c].width*C[c].height);return C.sort(l)}var c=e.Array32F,u=(e.Array8U,Math.abs),f=Math.max,h=Math.min,d=(Math.floor,Math.round,Math.sqrt),p=(e.Util.Array.typed,e.Util.Array.typed_obj),y="hasOwnProperty",m=10,v=Array.prototype.push,_=e.Util.Filter,g=_.sat,C=_.gradient;_.haar_detect=t,_.merge_features=s,e.Create({name:"HaarDetectorFilter",_update:!1,hasMeta:!0,haardata:null,tolerance:.2,baseScale:1,scaleIncrement:1.25,stepIncrement:.5,minNeighbors:1,doCannyPruning:!0,cannyLow:20,cannyHigh:100,_haarchanged:!1,init:function(e,r,t,a,i,o,l){var s=this;s.haardata=e||null,s.baseScale=n===r?1:+r,s.scaleIncrement=n===t?1.25:+t,s.stepIncrement=n===a?.5:+a,s.minNeighbors=n===i?1:+i,s.doCannyPruning=n===o?!0:!!o,s.tolerance=null==l?.2:+l,s._haarchanged=!!s.haardata},path:r,dispose:function(){var e=this;return e.haardata=null,e.$super("dispose"),e},haar:function(e){var n=this;return n.haardata=e,n._haarchanged=!0,n},params:function(e){var n=this;return e&&(e[y]("haardata")&&(n.haardata=e.haardata,n._haarchanged=!0),e[y]("baseScale")&&(n.baseScale=+e.baseScale),e[y]("scaleIncrement")&&(n.scaleIncrement=+e.scaleIncrement),e[y]("stepIncrement")&&(n.stepIncrement=+e.stepIncrement),e[y]("minNeighbors")&&(n.minNeighbors=+e.minNeighbors),e[y]("doCannyPruning")&&(n.doCannyPruning=!!e.doCannyPruning),e[y]("tolerance")&&(n.tolerance=+e.tolerance),e[y]("cannyLow")&&(n.cannyLow=+e.cannyLow),e[y]("cannyHigh")&&(n.cannyHigh=+e.cannyHigh),e[y]("selection")&&(n.selection=e.selection||null)),n},serialize:function(){var e,n=this;return e={baseScale:n.baseScale,scaleIncrement:n.scaleIncrement,stepIncrement:n.stepIncrement,minNeighbors:n.minNeighbors,doCannyPruning:n.doCannyPruning,tolerance:n.tolerance,cannyLow:n.cannyLow,cannyHigh:n.cannyHigh},n._haarchanged&&(e.haardata=p(n.haardata),n._haarchanged=!1),e},unserialize:function(e){var n=this;return e[y]("haardata")&&(n.haardata=p(e.haardata,1)),n.baseScale=e.baseScale,n.scaleIncrement=e.scaleIncrement,n.stepIncrement=e.stepIncrement,n.minNeighbors=e.minNeighbors,n.doCannyPruning=e.doCannyPruning,n.tolerance=e.tolerance,n.cannyLow=e.cannyLow,n.cannyHigh=e.cannyHigh,n},metaData:function(n){return n&&e.isWorker?p(this.meta):this.meta},setMetaData:function(e,n){return this.meta=n&&"string"==typeof e?p(e,1):e,this},apply:function(e,n,r,a){var i=this;if(!i.haardata)return e;var o,l,u,d,p,y=e.length,v=y>>>2,_=i.selection||null,b=null,Y=null,w=null,X=null;return _?_[4]?(o=h(n-1,f(0,_[0]*(n-1))),l=h(r-1,f(0,_[1]*(r-1))),u=h(n-1,f(0,_[2]*(n-1))),d=h(r-1,f(0,_[3]*(r-1)))):(o=h(n-1,f(0,_[0])),l=h(r-1,f(0,_[1])),u=h(n-1,f(0,_[2])),d=h(r-1,f(0,_[3]))):(o=0,l=0,u=n-1,d=r-1),a&&a.haarfilter_SAT?(b=a.haarfilter_SAT,Y=a.haarfilter_SAT2,w=a.haarfilter_RSAT):(g(e,n,r,2,0,b=new c(v),Y=new c(v),w=new c(v)),a&&(a.haarfilter_SAT=b,a.haarfilter_SAT2=Y,a.haarfilter_RSAT=w)),i.doCannyPruning&&(a&&a.haarfilter_GSAT?X=a.haarfilter_GSAT:(X=C(e,n,r,2,0,1,1),a&&(a.haarfilter_GSAT=X))),p=new Array(m),p.count=0,t(p,n,r,o,l,u,d,i.haardata,i.baseScale,i.scaleIncrement,i.stepIncrement,b,w,Y,X,i.cannyLow,i.cannyHigh),p.length>p.count&&(p.length=p.count),i.meta={objects:s(p,i.minNeighbors,i.tolerance)},e}})}(n),n});