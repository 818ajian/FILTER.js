/**
*
*   FILTER.js MachineLearning Routines
*   @version: 0.9.6
*   @dependencies: Filter.js
*
*   JavaScript Image Processing Library (Machine Learning Routines)
*   https://github.com/foo123/FILTER.js
*
**/!function(e,n){"use strict";"object"==typeof module&&module.exports?module.exports=n.call(e,module.$deps&&module.$deps.FILTER||require("./FILTER".toLowerCase())):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified("FILTER_ML")?define("FILTER_ML",["module","FILTER"],function(r,o){return n.moduleUri=r.uri,n.call(e,o),o}):(n.call(e,e.FILTER)||1)&&"function"==typeof define&&define.amd&&define(function(){return e.FILTER})}(this,function(e){return!function(e,n){"use strict";function r(e,n){for(;n[e][1]!==e;)n[e][1]=n[n[e][1]][1],e=n[e][1];return e}function o(e,n,o){var f=r(e,o),t=r(n,o);f!==t&&(o[f][1]=t)}function f(e,n,r){var o=r.next;return o+1>r.length&&Array.prototype.push.apply(r,new Array(p)),r[o]=[o,o,0],++r.next,o}function t(e,n,t,i,u,c,a,s,m){var y,L,h,x,I,M,E,F,R,T,w,A=n.length,g=A>>>e,v=8===c,q=v?-1:0,_=null,U=null!=m;for(E=new Array(p),E.next=0,F=new l(g),_=U?f(0,0,E):null,F[0]=U&&d(t[0]-m)>s?_:f(0,0,E),h=1;i>h;h++)F[h]=U&&d(t[h]-m)>s?_:d(t[h]-t[h-1])<=s?F[h-1]:f(h,0,E);for(x=1,M=i;u>x;x++,M+=i)for(F[M]=U&&d(t[M]-m)>s?_:d(t[M]-t[M-i])<=s?F[M-i]:f(0,x,E),h=1;i>h;h++)if(U&&d(t[M+h]-m)>s)F[M+h]=_;else{for(L=_===F[M+h-1]?-1:d(t[M+h]-t[M+h-1])<=s?F[M+h-1]:-1,I=q;1>I;I++)_!==F[M-i+h+I]&&d(t[M+h]-t[M-i+h+I])<=s&&(L>=0?o(L,F[M-i+h+I],E):L=F[M-i+h+I]);F[M+h]=L>=0?L:f(h,x,E),v&&_!==F[M+h-1]&&_!==F[M-i+h]&&d(t[M+h-1]-t[M-i+h])<=s&&o(F[M+h-1],F[M-i+h],E)}if(0===_)for(y=0,R=E.next,T=0;R>y;y++)y===E[y][1]&&(E[y][2]=0===E[y][1]?0:++T);else for(y=0,R=E.next,T=0;R>y;y++)y===E[y][1]&&(E[y][2]=T++);if(T=T>0?T:1,a)if(e)for(h=0,y=0;A>y;y+=4,h++)w=E[r(F[h],E)][2],w=255-255*w/T|0,n[y]=n[y+1]=n[y+2]=w;else for(h=0;A>h;h++)w=E[r(F[h],E)][2],w=255-255*w/T|0,n[h]=w;else if(e)for(h=0,y=0;A>y;y+=4,h++)w=E[r(F[h],E)][2],w=255*w/T|0,n[y]=n[y+1]=n[y+2]=w;else for(h=0;A>h;h++)w=E[r(F[h],E)][2],w=255*w/T|0,n[h]=w;return n}function i(e,n,r,o,f,t,i,p,m,y,L){var h,x,I,M,E,F,R,T,w,A,g,v,q,_,U,b=i.length,$=b>>>2,j=p<<2,C=0,k=b-j,z=0,B=p-1<<2;if(h=e,x=n,I=e,M=n,U=new l(c($/32)),v=new u($<<2),q=0,U[e+n>>>7]|=1<<(e+n>>>2&31),n+j>=C&&k>=n+j&&(v[q]=n,v[q+1]=e,v[q+2]=e,v[q+3]=j,q+=4),v[q]=n+j,v[q+1]=e,v[q+2]=e,v[q+3]=-j,q+=4,L)for(;q>0;){for(q-=4,j=v[q+3],g=v[q]+j,w=v[q+1],A=v[q+2],x=a(x,g),M=s(M,g),h=a(h,w),I=s(I,A),T=w;T>=z&&(F=T+g,R=F>>>2,!(U[R>>>5]&1<<(31&R))&&(d(r-i[F])>y||d(o-i[F+1])>y||d(f-i[F+2])>y));T-=4)U[R>>>5]|=1<<(31&R),h=a(h,T);if(T>=w){for(F=T+g,R=F>>>2;A>=T&&(U[R>>>5]&1<<(31&R)||d(r-i[F])<=y&&d(o-i[F+1])<=y&&d(f-i[F+2])<=y);)T+=4,F=T+g,R=F>>>2;E=T,_=A>=T}else E=T+4,w>E&&g-j>=C&&k>=g-j&&(v[q]=g,v[q+1]=E,v[q+2]=w-4,v[q+3]=-j,q+=4),T=w+4,_=!0;for(;_;){for(F=T+g,R=F>>>2;B>=T&&!(U[R>>>5]&1<<(31&R))&&(d(r-i[F])>y||d(o-i[F+1])>y||d(f-i[F+2])>y);)U[R>>>5]|=1<<(31&R),I=s(I,T),T+=4,F=T+g,R=F>>>2;for(g+j>=C&&k>=g+j&&(v[q]=g,v[q+1]=E,v[q+2]=T-4,v[q+3]=j,q+=4),T>A+4&&g-j>=C&&k>=g-j&&(v[q]=g,v[q+1]=A+4,v[q+2]=T-4,v[q+3]=-j,q+=4),F=T+g,R=F>>>2;A>=T&&(U[R>>>5]&1<<(31&R)||d(r-i[F])<=y&&d(o-i[F+1])<=y&&d(f-i[F+2])<=y);)T+=4,F=T+g,R=F>>>2;E=T,_=A>=T}}else for(;q>0;){for(q-=4,j=v[q+3],g=v[q]+j,w=v[q+1],A=v[q+2],x=a(x,g),M=s(M,g),h=a(h,w),I=s(I,A),T=w;T>=z&&(F=T+g,R=F>>>2,!(U[R>>>5]&1<<(31&R))&&d(r-i[F])<=y&&d(o-i[F+1])<=y&&d(f-i[F+2])<=y);T-=4)U[R>>>5]|=1<<(31&R),h=a(h,T);if(T>=w){for(F=T+g,R=F>>>2;A>=T&&(U[R>>>5]&1<<(31&R)||d(r-i[F])>y||d(o-i[F+1])>y||d(f-i[F+2])>y);)T+=4,F=T+g,R=F>>>2;E=T,_=A>=T}else E=T+4,w>E&&g-j>=C&&k>=g-j&&(v[q]=g,v[q+1]=E,v[q+2]=w-4,v[q+3]=-j,q+=4),T=w+4,_=!0;for(;_;){for(F=T+g,R=F>>>2;B>=T&&!(U[R>>>5]&1<<(31&R))&&d(r-i[F])<=y&&d(o-i[F+1])<=y&&d(f-i[F+2])<=y;)U[R>>>5]|=1<<(31&R),I=s(I,T),T+=4,F=T+g,R=F>>>2;for(g+j>=C&&k>=g+j&&(v[q]=g,v[q+1]=E,v[q+2]=T-4,v[q+3]=j,q+=4),T>A+4&&g-j>=C&&k>=g-j&&(v[q]=g,v[q+1]=A+4,v[q+2]=T-4,v[q+3]=-j,q+=4),F=T+g,R=F>>>2;A>=T&&(U[R>>>5]&1<<(31&R)||d(r-i[F])>y||d(o-i[F+1])>y||d(f-i[F+2])>y);)T+=4,F=T+g,R=F>>>2;E=T,_=A>=T}}return t[0]=h,t[1]=x,t[2]=I,t[3]=M,U}var u=e.Array32I,l=e.Array32U,c=(e.Array8U,Math.ceil),a=Math.min,s=Math.max,d=Math.abs,p=20;e.MachineLearning.connected_components=t,e.MachineLearning.connected_component=i}(e),e});