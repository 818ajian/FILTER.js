/**
*
*   FILTER.js MachineLearning Routines
*   @version: 0.9.6
*   @dependencies: Filter.js
*
*   JavaScript Image Processing Library (Machine Learning Routines)
*   https://github.com/foo123/FILTER.js
*
**/!function(e,r){"use strict";"object"==typeof module&&module.exports?module.exports=r.call(e,module.$deps&&module.$deps.FILTER||require("./FILTER".toLowerCase())):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified("FILTER_ML")?define("FILTER_ML",["module","FILTER"],function(n,o){return r.moduleUri=n.uri,r.call(e,o),o}):(r.call(e,e.FILTER)||1)&&"function"==typeof define&&define.amd&&define(function(){return e.FILTER})}(this,function(e){return!function(e,r){"use strict";function n(e,r){for(;r[e][1]!==e;)r[e][1]=r[r[e][1]][1],e=r[e][1];return e}function o(e,r,o){var f=n(e,o),t=n(r,o);f!==t&&(o[f][1]=t)}function f(e,r,n){var o=n.next;return o+1>n.length&&Array.prototype.push.apply(n,new Array(d)),n[o]=[o,o,0],++n.next,o}function t(e,r,t,i,u,l,c,s,p,y){i=0|i;var m,L,h,x,M,g,F,I,A,E,R=e.length,T=R>>>i,w=8===l,v=null,_=null!=p;for(g=new Array(d),g.next=0,F=new a(T),v=_?f(0,0,g):null,F[0]=_&&!c(u[0],p,s)?v:f(0,0,g),h=1;r>h;h++)F[h]=_&&!c(u[h],p,s)?v:c(u[h],u[h-1],s)?F[h-1]:f(h,0,g);for(x=1,M=r;t>x;x++,M+=r)for(F[M]=_&&!c(u[M],p,s)?v:c(u[M],u[M-r],s)?F[M-r]:f(0,x,g),h=1;r>h;h++)!_||c(u[M+h],p,s)?(L=v===F[M+h-1]?-1:c(u[M+h],u[M+h-1],s)?F[M+h-1]:-1,w&&v!==F[M-r+h-1]&&c(u[M+h],u[M-r+h-1],s)&&(L>-1?o(L,F[M-r+h-1],g):L=F[M-r+h-1]),v!==F[M-r+h]&&c(u[M+h],u[M-r+h],s)&&(L>-1?o(L,F[M-r+h],g):L=F[M-r+h]),F[M+h]=L>-1?L:f(h,x,g),w&&v!==F[M+h-1]&&v!==F[M-r+h]&&c(u[M+h-1],u[M-r+h],s)&&o(F[M+h-1],F[M-r+h],g)):F[M+h]=v;if(0===v)for(m=0,I=g.next,A=0;I>m;m++)m===g[m][1]&&(g[m][2]=0===g[m][1]?0:++A);else for(m=0,I=g.next,A=0;I>m;m++)m===g[m][1]&&(g[m][2]=A++);if(A=A>0?A:1,y)if(i)for(h=0,m=0;R>m;m+=4,h++)E=g[n(F[h],g)][2],E=255-255*E/A|0,e[m]=e[m+1]=e[m+2]=E;else for(h=0;R>h;h++)E=g[n(F[h],g)][2],E=255-255*E/A|0,e[h]=E;else if(i)for(h=0,m=0;R>m;m+=4,h++)E=g[n(F[h],g)][2],E=255*E/A|0,e[m]=e[m+1]=e[m+2]=E;else for(h=0;R>h;h++)E=g[n(F[h],g)][2],E=255*E/A|0,e[h]=E;return e}function i(e,r,n,o,f,t,i,d){o=0|o;var p,y,m,L,h,x,M,g,F,I,A,E,R,T,w,v,_=e.length,q=_>>>o,b=1<<o,U=r<<o,$=0,j=_-U,k=0,C=r-1<<o;if(p=i,y=d,m=i,L=d,w=new a(l(q/32)),E=new u(q<<2),R=0,M=i+d>>>o,w[M>>>5]|=1<<(31&M),d+U>=$&&j>=d+U&&(E[R]=d,E[R+1]=i,E[R+2]=i,E[R+3]=U,R+=4),E[R]=d+U,E[R+1]=i,E[R+2]=i,E[R+3]=-U,R+=4,o)for(;R>0;){for(R-=4,U=E[R+3],A=E[R]+U,F=E[R+1],I=E[R+2],y=c(y,A),L=s(L,A),p=c(p,F),m=s(m,I),g=F;g>=k&&(x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]],!(v||w[M>>>5]&1<<(31&M)));g-=b)w[M>>>5]|=1<<(31&M),p=c(p,g);if(g>=F){for(x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];I>=g&&(v||w[M>>>5]&1<<(31&M));)g+=b,x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];h=g,T=I>=g}else h=g+b,F>h&&A>=$+U&&j+U>=A&&(E[R]=A,E[R+1]=h,E[R+2]=F-b,E[R+3]=-U,R+=4),g=F+b,T=!0;for(;T;){for(x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];C>=g&&!v&&!(w[M>>>5]&1<<(31&M));)w[M>>>5]|=1<<(31&M),m=s(m,g),g+=b,x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];for(A+U>=$&&j>=A+U&&(E[R]=A,E[R+1]=h,E[R+2]=g-b,E[R+3]=U,R+=4),g>I+b&&A-U>=$&&j>=A-U&&(E[R]=A,E[R+1]=I+b,E[R+2]=g-b,E[R+3]=-U,R+=4),x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];I>=g&&(v||w[M>>>5]&1<<(31&M));)g+=b,x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];h=g,T=I>=g}}else for(;R>0;){for(R-=4,U=E[R+3],A=E[R]+U,F=E[R+1],I=E[R+2],y=c(y,A),L=s(L,A),p=c(p,F),m=s(m,I),g=F;g>=k&&(x=g+A,M=x,!(1&f[e[x]]||w[M>>>5]&1<<(31&M)));g-=b)w[M>>>5]|=1<<(31&M),p=c(p,g);if(g>=F){for(x=g+A,M=x;I>=g&&(1&f[e[x]]||w[M>>>5]&1<<(31&M));)g+=b,x=g+A,M=x;h=g,T=I>=g}else h=g+b,F>h&&A>=$+U&&j+U>=A&&(E[R]=A,E[R+1]=h,E[R+2]=F-b,E[R+3]=-U,R+=4),g=F+b,T=!0;for(;T;){for(x=g+A,M=x;C>=g&&!(1&f[e[x]])&&!(w[M>>>5]&1<<(31&M));)w[M>>>5]|=1<<(31&M),m=s(m,g),g+=b,x=g+A,M=x;for(A+U>=$&&j>=A+U&&(E[R]=A,E[R+1]=h,E[R+2]=g-b,E[R+3]=U,R+=4),g>I+b&&A-U>=$&&j>=A-U&&(E[R]=A,E[R+1]=I+b,E[R+2]=g-b,E[R+3]=-U,R+=4),x=g+A,M=x;I>=g&&(1&f[e[x]]||w[M>>>5]&1<<(31&M));)g+=b,x=g+A,M=x;h=g,T=I>=g}}return{mask:w,box:[p,y,m,L]}}var u=e.Array32I,a=e.Array32U,l=(e.Array32F,e.Array8U,Math.ceil),c=Math.min,s=Math.max,d=(Math.abs,256);e.MachineLearning.connected_components=t,e.MachineLearning.connected_region=e.MachineLearning.flood_region=i}(e),e});