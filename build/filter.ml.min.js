/**
*
*   FILTER.js MachineLearning Routines
*   @version: 0.9.6
*   @dependencies: Filter.js
*
*   JavaScript Image Processing Library (Machine Learning Routines)
*   https://github.com/foo123/FILTER.js
*
**/!function(e,r){"use strict";"object"==typeof module&&module.exports?module.exports=r.call(e,module.$deps&&module.$deps.FILTER||require("./FILTER".toLowerCase())):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified("FILTER_ML")?define("FILTER_ML",["module","FILTER"],function(n,o){return r.moduleUri=n.uri,r.call(e,o),o}):(r.call(e,e.FILTER)||1)&&"function"==typeof define&&define.amd&&define(function(){return e.FILTER})}(this,function(e){return!function(e,r){"use strict";function n(e,r){for(;r[e][1]!==e;)r[e][1]=r[r[e][1]][1],e=r[e][1];return e}function o(e,r,o){var f=n(e,o),t=n(r,o);f!==t&&(o[f][1]=t)}function f(e,r,n){var o=n.next;return o+1>n.length&&Array.prototype.push.apply(n,new Array(d)),n[o]=[o,o,0],++n.next,o}function t(e,r,t,i,a,c,l,p,h){var m,y,L,M,g,v,w,x,A,E,F,I=r.length,R=I>>>e,T=8===c,b=T?-1:0,k=null,q=null!=h;for(w=new Array(d),w.next=0,x=new u(R),k=q?f(0,0,w):null,x[0]=q&&s(t[0]-h)>p?k:f(0,0,w),L=1;i>L;L++)x[L]=q&&s(t[L]-h)>p?k:s(t[L]-t[L-1])<=p?x[L-1]:f(L,0,w);for(M=1,v=i;a>M;M++,v+=i)for(x[v]=q&&s(t[v]-h)>p?k:s(t[v]-t[v-i])<=p?x[v-i]:f(0,M,w),L=1;i>L;L++)if(q&&s(t[v+L]-h)>p)x[v+L]=k;else{for(y=k===x[v+L-1]?-1:s(t[v+L]-t[v+L-1])<=p?x[v+L-1]:-1,g=b;1>g;g++)k!==x[v-i+L+g]&&s(t[v+L]-t[v-i+L+g])<=p&&(y>=0?o(y,x[v-i+L+g],w):y=x[v-i+L+g]);x[v+L]=y>=0?y:f(L,M,w),T&&k!==x[v+L-1]&&k!==x[v-i+L]&&s(t[v+L-1]-t[v-i+L])<=p&&o(x[v+L-1],x[v-i+L],w)}if(0===k)for(m=0,A=w.next,E=0;A>m;m++)m===w[m][1]&&(w[m][2]=0===w[m][1]?0:++E);else for(m=0,A=w.next,E=0;A>m;m++)m===w[m][1]&&(w[m][2]=E++);if(E=E>0?E:1,l)if(e)for(L=0,m=0;I>m;m+=4,L++)F=w[n(x[L],w)][2],F=255-255*F/E|0,r[m]=r[m+1]=r[m+2]=F;else for(L=0;I>L;L++)F=w[n(x[L],w)][2],F=255-255*F/E|0,r[L]=F;else if(e)for(L=0,m=0;I>m;m+=4,L++)F=w[n(x[L],w)][2],F=255*F/E|0,r[m]=r[m+1]=r[m+2]=F;else for(L=0;I>L;L++)F=w[n(x[L],w)][2],F=255*F/E|0,r[L]=F;return r}function i(e,r,n,o,f,t,i,u,d,p){var h,m,y,L,M,g,v,w,x,A,E,F,I,R,T,b,k=i.length,q=k>>>2,_=u<<2,U=0,$=k-_,j=0,C=u-1<<2;for(h=e,m=r,y=e,L=r,b=new a(q),F=new Array(q),I=0,b[e+r>>>2]=255,r+_>=U&&$>=r+_&&(F[I++]=[r,e,e,_]),F[I++]=[r+_,e,e,-_];I>0;){for(R=F[--I],E=R[0]+(_=R[3]),x=R[1],A=R[2],m=c(m,E),L=l(L,E),h=c(h,x),y=l(y,A),w=x;w>=j&&(g=w+E,v=g>>>2,0===b[v]&&s(n-i[g])<=p&&s(o-i[g+1])<=p&&s(f-i[g+2])<=p);w-=4)b[v]=255,h=c(h,w);if(w>=x){for(g=w+E,v=g>>>2;A>=w&&(0!==b[v]||s(n-i[g])>p||s(o-i[g+1])>p||s(f-i[g+2])>p);)w+=4,g=w+E,v=g>>>2;M=w,T=A>=w}else M=w+4,x>M&&E-_>=U&&$>=E-_&&(F[I++]=[E,M,x-4,-_]),w=x+4,T=!0;for(;T;){for(g=w+E,v=g>>>2;C>=w&&0===b[v]&&s(n-i[g])<=p&&s(o-i[g+1])<=p&&s(f-i[g+2])<=p;)b[v]=255,y=l(y,w),w+=4,g=w+E,v=g>>>2;for(E+_>=U&&$>=E+_&&(F[I++]=[E,M,w-4,_]),w>A+4&&E-_>=U&&$>=E-_&&(F[I++]=[E,A+4,w-4,-_]),g=w+E,v=g>>>2;A>=w&&(0!==b[v]||s(n-i[g])>p||s(o-i[g+1])>p||s(f-i[g+2])>p);)w+=4,g=w+E,v=g>>>2;M=w,T=A>=w}}return t[0]=h,t[1]=m,t[2]=y,t[3]=L,b}var u=e.Array32U,a=e.Array8U,c=Math.min,l=Math.max,s=Math.abs,d=20;e.MachineLearning.connected_components=t,e.MachineLearning.connected_component=i}(e),!function(e,r){"use strict";var n=Math.abs;e.MachineLearning.kmeans=function(e,r,o,f,t,i){i=i||0;for(var u,a,c,l,s,d,p,h,m=r.length,y=new Array(m);;){for(p=0,a=0;m>a;a++){for(s=r[a],l=f(o[0],s),d=0,u=1;e>u;u++)c=f(o[u],s),l>c&&(l=c,d=u);y[a]=d,p+=l}for(u=0;e>u;u++)o[u]=null;for(a=0;m>a;a++)s=r[a],d=y[a],o[d]=t(o[d],s);for(h=0,a=0;m>a;a++)h+=f(o[y[a]],r[a]);if(n(h-p)<=i)break}return y},e.MachineLearning.kmedoids=function(e,r,o,f,t){t=t||0;for(var i,u,a,c,l,s,d,p,h,m,y,L,M=r.length,g=new Array(M);;){for(m=0,u=0;M>u;u++){for(s=r[u],l=f(o[0],s),h=0,i=1;e>i;i++)c=f(o[i],s),l>c&&(l=c,h=i);g[u]=h,m+=l}for(i=0,L=!1;e>i&&!L;){for(d=o[i],u=0;M>u;u++)if(p=r[u],p!==o[g[u]]){for(o[i]=p,y=0,a=0;M>a;a++)y+=f(o[g[a]],r[a]);if(n(y)+t<n(m)){L=!0;break}o[i]=d}i++}if(!L)break}return g}}(e),e});