/**
*
*   FILTER.js MachineLearning Routines
*   @version: 0.9.6
*   @dependencies: Filter.js
*
*   JavaScript Image Processing Library (Machine Learning Routines)
*   https://github.com/foo123/FILTER.js
*
**/!function(e,n){"use strict";"object"==typeof module&&module.exports?module.exports=n.call(e,module.$deps&&module.$deps.FILTER||require("./FILTER".toLowerCase())):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified("FILTER_ML")?define("FILTER_ML",["module","FILTER"],function(r,o){return n.moduleUri=r.uri,n.call(e,o),o}):(n.call(e,e.FILTER)||1)&&"function"==typeof define&&define.amd&&define(function(){return e.FILTER})}(this,function(e){return!function(e,n){"use strict";function r(e,n){for(;n[e][1]!==e;)n[e][1]=n[n[e][1]][1],e=n[e][1];return e}function o(e,n,o){var t=r(e,o),f=r(n,o);t!==f&&(o[t][1]=f)}function t(e,n,r){var o=r.next;return o+1>r.length&&Array.prototype.push.apply(r,new Array(p)),r[o]=[o,o,0],++r.next,o}function f(e,n,f,i,u,l,a,d,m){var y,L,h,x,I,M,E,F,R,T,w,A=n.length,g=A>>>e,v=8===l,q=v?-1:0,_=null,U=null!=m;for(E=new Array(p),E.next=0,F=new c(g),_=U?t(0,0,E):null,F[0]=U&&s(f[0]-m)>d?_:t(0,0,E),h=1;i>h;h++)F[h]=U&&s(f[h]-m)>d?_:s(f[h]-f[h-1])<=d?F[h-1]:t(h,0,E);for(x=1,M=i;u>x;x++,M+=i)for(F[M]=U&&s(f[M]-m)>d?_:s(f[M]-f[M-i])<=d?F[M-i]:t(0,x,E),h=1;i>h;h++)if(U&&s(f[M+h]-m)>d)F[M+h]=_;else{for(L=_===F[M+h-1]?-1:s(f[M+h]-f[M+h-1])<=d?F[M+h-1]:-1,I=q;1>I;I++)_!==F[M-i+h+I]&&s(f[M+h]-f[M-i+h+I])<=d&&(L>=0?o(L,F[M-i+h+I],E):L=F[M-i+h+I]);F[M+h]=L>=0?L:t(h,x,E),v&&_!==F[M+h-1]&&_!==F[M-i+h]&&s(f[M+h-1]-f[M-i+h])<=d&&o(F[M+h-1],F[M-i+h],E)}if(0===_)for(y=0,R=E.next,T=0;R>y;y++)y===E[y][1]&&(E[y][2]=0===E[y][1]?0:++T);else for(y=0,R=E.next,T=0;R>y;y++)y===E[y][1]&&(E[y][2]=T++);if(T=T>0?T:1,a)if(e)for(h=0,y=0;A>y;y+=4,h++)w=E[r(F[h],E)][2],w=255-255*w/T|0,n[y]=n[y+1]=n[y+2]=w;else for(h=0;A>h;h++)w=E[r(F[h],E)][2],w=255-255*w/T|0,n[h]=w;else if(e)for(h=0,y=0;A>y;y+=4,h++)w=E[r(F[h],E)][2],w=255*w/T|0,n[y]=n[y+1]=n[y+2]=w;else for(h=0;A>h;h++)w=E[r(F[h],E)][2],w=255*w/T|0,n[h]=w;return n}function i(e,n,r,o,t,f,i,p,m,y){var L,h,x,I,M,E,F,R,T,w,A,g,v,q,_,U=i.length,b=U>>>2,$=p<<2,j=0,C=U-$,k=0,z=p-1<<2;for(L=e,h=n,x=e,I=n,_=new c(l(b/32)),g=new u(b<<2),v=0,_[e+n>>>7]|=1<<(e+n>>>2&31),n+$>=j&&C>=n+$&&(g[v]=n,g[v+1]=e,g[v+2]=e,g[v+3]=$,v+=4),g[v]=n+$,g[v+1]=e,g[v+2]=e,g[v+3]=-$,v+=4;v>0;){for(v-=4,$=g[v+3],A=g[v]+$,T=g[v+1],w=g[v+2],h=a(h,A),I=d(I,A),L=a(L,T),x=d(x,w),R=T;R>=k&&(E=R+A,F=E>>>2,!(_[F>>>5]&1<<(31&F))&&s(r-i[E])<=y&&s(o-i[E+1])<=y&&s(t-i[E+2])<=y);R-=4)_[F>>>5]|=1<<(31&F),L=a(L,R);if(R>=T){for(E=R+A,F=E>>>2;w>=R&&(_[F>>>5]&1<<(31&F)||s(r-i[E])>y||s(o-i[E+1])>y||s(t-i[E+2])>y);)R+=4,E=R+A,F=E>>>2;M=R,q=w>=R}else M=R+4,T>M&&A-$>=j&&C>=A-$&&(g[v]=A,g[v+1]=M,g[v+2]=T-4,g[v+3]=-$,v+=4),R=T+4,q=!0;for(;q;){for(E=R+A,F=E>>>2;z>=R&&!(_[F>>>5]&1<<(31&F))&&s(r-i[E])<=y&&s(o-i[E+1])<=y&&s(t-i[E+2])<=y;)_[F>>>5]|=1<<(31&F),x=d(x,R),R+=4,E=R+A,F=E>>>2;for(A+$>=j&&C>=A+$&&(g[v]=A,g[v+1]=M,g[v+2]=R-4,g[v+3]=$,v+=4),R>w+4&&A-$>=j&&C>=A-$&&(g[v]=A,g[v+1]=w+4,g[v+2]=R-4,g[v+3]=-$,v+=4),E=R+A,F=E>>>2;w>=R&&(_[F>>>5]&1<<(31&F)||s(r-i[E])>y||s(o-i[E+1])>y||s(t-i[E+2])>y);)R+=4,E=R+A,F=E>>>2;M=R,q=w>=R}}return f[0]=L,f[1]=h,f[2]=x,f[3]=I,_}var u=e.Array32I,c=e.Array32U,l=(e.Array8U,Math.ceil),a=Math.min,d=Math.max,s=Math.abs,p=20;e.MachineLearning.connected_components=f,e.MachineLearning.connected_component=i}(e),e});