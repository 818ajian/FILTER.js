/**
*
*   FILTER.js MachineLearning Routines
*   @version: 0.9.6
*   @dependencies: Filter.js
*
*   JavaScript Image Processing Library (Machine Learning Routines)
*   https://github.com/foo123/FILTER.js
*
**/!function(e,r){"use strict";"object"==typeof module&&module.exports?module.exports=r.call(e,module.$deps&&module.$deps.FILTER||require("./FILTER".toLowerCase())):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified("FILTER_ML")?define("FILTER_ML",["module","FILTER"],function(n,o){return r.moduleUri=n.uri,r.call(e,o),o}):(r.call(e,e.FILTER)||1)&&"function"==typeof define&&define.amd&&define(function(){return e.FILTER})}(this,function(e){return!function(e,r){"use strict";function n(e,r){for(;r[e][1]!==e;)r[e][1]=r[r[e][1]][1],e=r[e][1];return e}function o(e,r,o){var f=n(e,o),t=n(r,o);f!==t&&(o[f][1]=t)}function f(e,r,n){var o=n.next;return o+1>n.length&&Array.prototype.push.apply(n,new Array(p)),n[o]=[o,o,0],++n.next,o}function t(e,r,t,i,u,a,c,s,y){i=0|i;var m,L,h,x,M,g,F,I,A,E,R,T=e.length,w=T>>>i,v=8===a,_=v?-1:0,q=null,b=null!=s;for(F=new Array(p),F.next=0,I=new l(w),q=b?f(0,0,F):null,I[0]=b&&d(u[0]-s)>c?q:f(0,0,F),h=1;r>h;h++)I[h]=b&&d(u[h]-s)>c?q:d(u[h]-u[h-1])<=c?I[h-1]:f(h,0,F);for(x=1,g=r;t>x;x++,g+=r)for(I[g]=b&&d(u[g]-s)>c?q:d(u[g]-u[g-r])<=c?I[g-r]:f(0,x,F),h=1;r>h;h++)if(b&&d(u[g+h]-s)>c)I[g+h]=q;else{for(L=q===I[g+h-1]?-1:d(u[g+h]-u[g+h-1])<=c?I[g+h-1]:-1,M=_;1>M;M++)q!==I[g-r+h+M]&&d(u[g+h]-u[g-r+h+M])<=c&&(L>=0?o(L,I[g-r+h+M],F):L=I[g-r+h+M]);I[g+h]=L>=0?L:f(h,x,F),v&&q!==I[g+h-1]&&q!==I[g-r+h]&&d(u[g+h-1]-u[g-r+h])<=c&&o(I[g+h-1],I[g-r+h],F)}if(0===q)for(m=0,A=F.next,E=0;A>m;m++)m===F[m][1]&&(F[m][2]=0===F[m][1]?0:++E);else for(m=0,A=F.next,E=0;A>m;m++)m===F[m][1]&&(F[m][2]=E++);if(E=E>0?E:1,y)if(i)for(h=0,m=0;T>m;m+=4,h++)R=F[n(I[h],F)][2],R=255-255*R/E|0,e[m]=e[m+1]=e[m+2]=R;else for(h=0;T>h;h++)R=F[n(I[h],F)][2],R=255-255*R/E|0,e[h]=R;else if(i)for(h=0,m=0;T>m;m+=4,h++)R=F[n(I[h],F)][2],R=255*R/E|0,e[m]=e[m+1]=e[m+2]=R;else for(h=0;T>h;h++)R=F[n(I[h],F)][2],R=255*R/E|0,e[h]=R;return e}function i(e,r,n,o,f,t,i,d){o=0|o;var p,y,m,L,h,x,M,g,F,I,A,E,R,T,w,v,_=e.length,q=_>>>o,b=1<<o,U=r<<o,$=0,j=_-U,k=0,C=r-1<<o;if(p=i,y=d,m=i,L=d,w=new l(a(q/32)),E=new u(q<<2),R=0,M=i+d>>>o,w[M>>>5]|=1<<(31&M),d+U>=$&&j>=d+U&&(E[R]=d,E[R+1]=i,E[R+2]=i,E[R+3]=U,R+=4),E[R]=d+U,E[R+1]=i,E[R+2]=i,E[R+3]=-U,R+=4,o)for(;R>0;){for(R-=4,U=E[R+3],A=E[R]+U,F=E[R+1],I=E[R+2],y=c(y,A),L=s(L,A),p=c(p,F),m=s(m,I),g=F;g>=k&&(x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]],!(v||w[M>>>5]&1<<(31&M)));g-=b)w[M>>>5]|=1<<(31&M),p=c(p,g);if(g>=F){for(x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];I>=g&&(v||w[M>>>5]&1<<(31&M));)g+=b,x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];h=g,T=I>=g}else h=g+b,F>h&&A>=$+U&&j+U>=A&&(E[R]=A,E[R+1]=h,E[R+2]=F-b,E[R+3]=-U,R+=4),g=F+b,T=!0;for(;T;){for(x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];C>=g&&!v&&!(w[M>>>5]&1<<(31&M));)w[M>>>5]|=1<<(31&M),m=s(m,g),g+=b,x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];for(A+U>=$&&j>=A+U&&(E[R]=A,E[R+1]=h,E[R+2]=g-b,E[R+3]=U,R+=4),g>I+b&&A-U>=$&&j>=A-U&&(E[R]=A,E[R+1]=I+b,E[R+2]=g-b,E[R+3]=-U,R+=4),x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];I>=g&&(v||w[M>>>5]&1<<(31&M));)g+=b,x=g+A,M=x>>>o,v=1&f[e[x]]|2&f[e[x+1]]|4&f[e[x+2]];h=g,T=I>=g}}else for(;R>0;){for(R-=4,U=E[R+3],A=E[R]+U,F=E[R+1],I=E[R+2],y=c(y,A),L=s(L,A),p=c(p,F),m=s(m,I),g=F;g>=k&&(x=g+A,M=x,!(1&f[e[x]]||w[M>>>5]&1<<(31&M)));g-=b)w[M>>>5]|=1<<(31&M),p=c(p,g);if(g>=F){for(x=g+A,M=x;I>=g&&(1&f[e[x]]||w[M>>>5]&1<<(31&M));)g+=b,x=g+A,M=x;h=g,T=I>=g}else h=g+b,F>h&&A>=$+U&&j+U>=A&&(E[R]=A,E[R+1]=h,E[R+2]=F-b,E[R+3]=-U,R+=4),g=F+b,T=!0;for(;T;){for(x=g+A,M=x;C>=g&&!(1&f[e[x]])&&!(w[M>>>5]&1<<(31&M));)w[M>>>5]|=1<<(31&M),m=s(m,g),g+=b,x=g+A,M=x;for(A+U>=$&&j>=A+U&&(E[R]=A,E[R+1]=h,E[R+2]=g-b,E[R+3]=U,R+=4),g>I+b&&A-U>=$&&j>=A-U&&(E[R]=A,E[R+1]=I+b,E[R+2]=g-b,E[R+3]=-U,R+=4),x=g+A,M=x;I>=g&&(1&f[e[x]]||w[M>>>5]&1<<(31&M));)g+=b,x=g+A,M=x;h=g,T=I>=g}}return{mask:w,box:[p,y,m,L]}}var u=e.Array32I,l=e.Array32U,a=(e.Array32F,e.Array8U,Math.ceil),c=Math.min,s=Math.max,d=Math.abs,p=256;e.MachineLearning.connected_components=t,e.MachineLearning.connected_region=e.MachineLearning.flood_region=i}(e),e});